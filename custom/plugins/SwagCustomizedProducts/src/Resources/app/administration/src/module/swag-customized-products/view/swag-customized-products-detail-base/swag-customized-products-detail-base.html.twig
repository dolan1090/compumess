{% block swag_customized_products_detail_base %}
    <div class="swag-customized-products-detail-base">

        {% block swag_customized_products_detail_base_card_general_assignment_info %}
            <sw-alert
                v-if="!isCreateMode"
                variant="info"
                class="swag-customized-product__assignment-info">
                <p>{{ $tc('swag-customized-products.detail.tabGeneral.textAssignmentInfo') }}</p>
            </sw-alert>
        {% endblock %}

        {% block swag_customized_products_detail_base_card_general %}
            <sw-card :title="$tc('swag-customized-products.detail.tabGeneral.cardGeneral')">
                <sw-container columns="repeat(auto-fit, minmax(250px, 1fr)" gap="0 30px">

                    {% block swag_customized_products_detail_base_card_general_internal_name %}
                        <sw-text-field
                            {% if VUE3 %}
                                v-model:value="template.internalName"
                            {% else %}
                                v-model="template.internalName"
                            {% endif %}
                            name="sw-field--template-internalName"
                            :label="$tc('swag-customized-products.detail.tabGeneral.labelInternalName')"
                            :placeholder="$tc('swag-customized-products.detail.tabGeneral.placeholderInternalName')"
                            :error="templateInternalNameError"
                            :disabled="!acl.can('swag_customized_products_template.editor')"
                            required>
                        </sw-text-field>
                    {% endblock %}

                    {% block swag_customized_products_detail_base_card_general_active %}
                        <sw-switch-field
                            {% if VUE3 %}
                                v-model:value="template.active"
                            {% else %}
                                v-model="template.active"
                            {% endif %}
                            name="sw-field--template-active"
                            :label="$tc('swag-customized-products.detail.tabGeneral.labelActive')"
                            :disabled="!acl.can('swag_customized_products_template.editor')"
                            bordered>
                        </sw-switch-field>
                    {% endblock %}
                </sw-container>

                {% block swag_customized_products_detail_base_card_general_display_name %}
                    <sw-text-field
                        {% if VUE3 %}
                            v-model:value="template.displayName"
                        {% else %}
                            v-model="template.displayName"
                        {% endif %}
                        name="sw-field--template-displayName"
                        :label="$tc('swag-customized-products.detail.tabGeneral.labelDisplayName')"
                        :placeholder="$tc('swag-customized-products.detail.tabGeneral.placeholderDisplayName')"
                        :error="templateDisplayNameError"
                        :disabled="!acl.can('swag_customized_products_template.editor')"
                        required>
                    </sw-text-field>
                {% endblock %}

                {% block swag_customized_products_detail_base_card_general_description %}
                    <sw-text-editor
                        v-model="template.description"
                        :label="$tc('swag-customized-products.detail.tabGeneral.labelDescription')"
                        :disabled="!acl.can('swag_customized_products_template.editor')"
                        :placeholder="$tc('swag-customized-products.detail.tabGeneral.placeholderDescription')">
                    </sw-text-editor>
                {% endblock %}

                {% block swag_customized_products_detail_base_card_general_media %}
                    <sw-upload-listener
                        :uploadTag="uploadTag"
                        autoUpload
                        @media-upload-finish="setMediaItem">
                    </sw-upload-listener>
                    <sw-media-upload-v2
                        class="swag-customized-products-detail-base__image-upload"
                        :uploadTag="uploadTag"
                        :source="displayMediaItem"
                        :allowMultiSelect="false"
                        :label="$tc('swag-customized-products.detail.tabGeneral.labelImage')"
                        :defaultFolder="templateRepository.schema.entity"
                        :disabled="!acl.can('swag_customized_products_template.editor')"
                        @media-drop="onDropMedia"
                        @media-upload-sidebar-open="openMediaSidebar"
                        @media-upload-remove-image="onUnlinkImage">
                    </sw-media-upload-v2>
                {% endblock %}

                {% block swag_customized_products_detail_base_card_general_step_by_step_options_auto_collapse_container %}
                    <sw-container columns="repeat(auto-fit, minmax(250px, 1fr)" gap="0 30px">

                        {% block swag_customized_products_detail_base_card_general_step_by_step %}
                            <sw-switch-field
                                {% if VUE3 %}
                                    v-model:value="template.stepByStep"
                                {% else %}
                                    v-model="template.stepByStep"
                                {% endif %}
                                class="swag-customized-products-base-step-by-step__checkbox-field"
                                :label="$tc('swag-customized-products.detail.tabGeneral.labelStepByStep')"
                                :helpText="$tc('swag-customized-products.detail.tabGeneral.helpTextStepByStep')"
                                bordered
                                :disabled="!acl.can('swag_customized_products_template.editor')"
                                @change="onChangeStepByStep">
                            </sw-switch-field>
                        {% endblock %}

                        {% block swag_customized_products_detail_base_card_general_options_auto_collapse %}
                            <sw-switch-field
                                {% if VUE3 %}
                                    v-model:value="template.optionsAutoCollapse"
                                {% else %}
                                    v-model="template.optionsAutoCollapse"
                                {% endif %}
                                class="swag-customized-products-base-options-auto-collapse__checkbox-field"
                                :disabled="template.stepByStep || !acl.can('swag_customized_products_template.editor')"
                                :label="$tc('swag-customized-products.detail.tabGeneral.labelOptionsAutoCollapse')"
                                :helpText="$tc('swag-customized-products.detail.tabGeneral.helpTextOptionsAutoCollapse')"
                                bordered>
                            </sw-switch-field>
                        {% endblock %}
                    </sw-container>
                {% endblock %}

                {% block swag_customized_products_detail_base_card_general_confirm_input %}
                    <sw-switch-field
                        {% if VUE3 %}
                            v-model:value="template.confirmInput"
                        {% else %}
                            v-model="template.confirmInput"
                        {% endif %}
                        class="swag-customized-products-base-confirmInput__checkbox-field"
                        :label="$tc('swag-customized-products.detail.tabGeneral.labelConfirmInput')"
                        :helpText="$tc('swag-customized-products.detail.tabGeneral.helpTextConfirmInput')"
                        :disabled="!acl.can('swag_customized_products_template.editor')"
                        bordered>
                    </sw-switch-field>
                {% endblock %}
            </sw-card>
        {% endblock %}

        {% block swag_customized_products_detail_base_option_card %}
            <sw-card v-if="!isCreateMode"
                     :title="$tc('swag-customized-products.detail.tabGeneral.cardOption.title')">

                {% block swag_customized_products_detail_base_option_grid_toolbar %}
                    <template #toolbar>
                        <sw-card-filter
                            :placeholder="$tc('swag-customized-products.detail.tabGeneral.cardOption.placeholderSearch')"
                            @sw-card-filter-term-change="onOptionSearch">
                            <template #filter>

                                {% block sw_customer_detail_addresses_add_button %}
                                    <sw-button
                                        class="swag-customized-products-detail-base__add-option-action"
                                        v-tooltip="{ message: $tc('swag-customized-products.detail.tabGeneral.cardOption.optionAddNotAvailableTooltip'), disabled: !optionAddDisabled, showOnDisabledElements: true }"
                                        :disabled="optionAddDisabled || !acl.can('swag_customized_products_template.editor')"
                                        size="small"
                                        variant="ghost"
                                        @click="onOptionAdd">
                                        {{ $tc('swag-customized-products.detail.tabGeneral.cardOption.buttonAdd') }}
                                    </sw-button>
                                {% endblock %}
                            </template>
                        </sw-card-filter>
                    </template>
                {% endblock %}

                {% block swag_customized_products_detail_base_option_grid_content %}
                    <template #grid>
                        <swag-customized-products-option-list
                                v-if="filteredOptions.length > 0 || options.length > 0"
                                class="swag-customized-products-detail-base__option-grid"
                                ref="grid"
                                :collection="(optionSearchTerm.length > 0 ? filteredOptions : options)"
                                :localMode="false"
                                :columns="optionColumns"
                                :isLoading="isLoading"
                                :sortBy="optionSortProperty"
                                :sortDirection="optionSortDirection"
                                :skeletonItemAmount="10"
                                :allowInlineEdit="false"
                                :allowDelete="acl.can('swag_customized_products_template.deleter')"
                                @select-item="onOptionSelectionChanged"
                                @select-all-items="onOptionSelectionChanged">

                            {% block swag_customized_products_detail_base_option_grid_columns %}
                                {% block swag_customized_products_detail_base_option_grid_column_name %}
                                    <template #column-displayName="{ item }">
                                        <a class="link" @click="onOptionEdit(item)">
                                            {{ item.translated.displayName }}
                                        </a>
                                    </template>
                                {% endblock %}

                                {% block swag_customized_products_detail_base_option_grid_column_type %}
                                    <template #column-type="{ item }">

                                        {% block swag_customized_products_detail_base_option_grid_column_type_content %}
                                            {{ translateOption(item.type) }}
                                        {% endblock %}
                                    </template>
                                {% endblock %}

                                {% block swag_customized_products_detail_base_option_grid_column_values_count %}
                                    <template #column-valuesCount="{ item }">
                                        {{ item.values.length }}
                                    </template>
                                {% endblock %}

                                {% block swag_customized_products_detail_base_option_grid_column_position %}
                                    <template #column-position="{ item }">
                                        <sw-data-grid-column-position
                                            {% if VUE3 %}
                                                v-model:value="options"
                                            {% else %}
                                                v-model="options"
                                            {% endif %}
                                            :disabled="!!optionSearchTerm || !acl.can('swag_customized_products_template.editor')"
                                            :item="item"
                                            @position-changed="saveOptions">
                                        </sw-data-grid-column-position>
                                    </template>
                                {% endblock %}

                                {% block swag_customized_products_detail_base_option_grid_actions %}
                                    <template #actions="{ item }">

                                        {% block swag_customized_products_detail_base_option_grid_actions_edit %}
                                            <sw-context-menu-item
                                                @click="onOptionEdit(item)"
                                                :disabled="!acl.can('swag_customized_products_template.viewer')">
                                                {{ $tc('global.default.edit') }}
                                            </sw-context-menu-item>
                                        {% endblock %}

                                        {% block swag_customized_products_detail_base_option_grid_actions_delete %}
                                            <sw-context-menu-item
                                                variant="danger"
                                                @click="onOptionDelete(item)"
                                                :disabled="!acl.can('swag_customized_products_template.editor')"
                                            >
                                                {{ $tc('global.default.delete') }}
                                            </sw-context-menu-item>
                                        {% endblock %}
                                    </template>
                                {% endblock %}

                                {% block swag_customized_products_detail_base_option_grid_bulk_actions %}
                                    <template #bulk>

                                        {% block swag_customized_products_detail_base_option_grid_bulk_actions_delete %}
                                            <a class="link link-danger"
                                               @click="onOptionBulkDelete"
                                               v-if="acl.can('swag_customized_products_template.editor')">
                                                {{ $tc('global.default.delete') }}
                                            </a>
                                        {% endblock %}
                                    </template>
                                {% endblock %}
                            {% endblock %}
                        </swag-customized-products-option-list>

                        {% block sw_customer_detail_order_card_grid_empty_state %}
                            <template v-else>
                                <div class="swag-customized-products-detail-base__empty-state">
                                    <img :src="'/administration/static/img/empty-states/products-empty-state.svg' | asset">

                                    <div class="swag-customized-products-detail-base__empty-state--label">
                                        <p>{{ $tc('swag-customized-products.detail.tabGeneral.cardOption.emptyTitle', !optionSearchTerm) }}</p>
                                    </div>
                                </div>
                            </template>
                        {% endblock %}
                    </template>
                {% endblock %}

            </sw-card>
        {% endblock %}

        {% block swag_customized_products_detail_base_option_detail_modal %}
        <template v-if="showOptionDetailModal">
            <swag-customized-products-option-detail-modal
                :option="showOptionDetailModal"
                :optionRepository="optionRepository"
                :versionContext="versionContext"
                @modal-close="onOptionCloseDetailModal">
            </swag-customized-products-option-detail-modal>
        </template>
        {% endblock %}

        {% block swag_customized_products_detail_base_option_create_modal %}
            <sw-modal v-if="showOptionCreateModal"
                      :title="$tc('swag-customized-products.detail.tabGeneral.createOption.title')"
                      @modal-close="onOptionCloseCreateModal">

                {% block swag_customized_products_detail_base_option_create_modal_form %}
                    <sw-container class="swag-customized-products-detail-base__create-modal-form"
                                  columns="1fr 1fr"
                                  gap="32px">

                        {% block swag_customized_products_detail_base_option_create_modal_field_name %}
                            <sw-text-field {% if VUE3 %}
                                                v-model:value="newOption.displayName"
                                           {% else %}
                                                v-model="newOption.displayName"
                                           {% endif %}
                                           name="sw-field--newOption-displayName"
                                           :label="$tc('swag-customized-products.detail.tabGeneral.createOption.nameLabel')"
                                           :placeholder="$tc('swag-customized-products.detail.tabGeneral.createOption.namePlaceholder')"
                                           @keyup.enter="onOptionConfirmCreate"
                                           @keyup.esc="onOptionCloseCreateModal">
                            </sw-text-field>
                        {% endblock %}

                        {% block swag_customized_products_detail_base_option_create_modal_field_type %}
                            <sw-select-field {% if VUE3 %}
                                                v-model:value="newOption.type"
                                             {% else %}
                                                v-model="newOption.type"
                                             {% endif %}
                                             name="sw-field--newOption-type"
                                             :label="$tc('swag-customized-products.detail.tabGeneral.createOption.typeLabel')"
                                             :helpText="$tc('swag-customized-products.detail.tabGeneral.createOption.typeHelpText')">

                                {% block swag_customized_products_detail_base_option_create_modal_field_type_options %}
                                    <option v-for="type in optionTypes" :value="type">{{ translateOption(type) }}</option>
                                {% endblock %}
                            </sw-select-field>
                        {% endblock %}
                    </sw-container>
                {% endblock %}

                {% block swag_customized_products_detail_base_option_create_modal_footer %}
                    <template #modal-footer>

                        {% block swag_customized_products_detail_base_option_create_modal_cancel %}
                            <sw-button size="small"
                                       @click="onOptionCloseCreateModal">
                                {{ $tc('global.default.cancel') }}
                            </sw-button>
                        {% endblock %}

                        {% block swag_customized_products_detail_base_option_create_modal_confirm %}
                            <sw-button variant="primary"
                                       size="small"
                                       :disabled="optionConfirmCreateDisabled"
                                       @click="onOptionConfirmCreate">
                                {{ $tc('global.default.add') }}
                            </sw-button>
                        {% endblock %}
                    </template>
                {% endblock %}
            </sw-modal>
        {% endblock %}

        {% block swag_customized_products_detail_base_option_delete_modal %}
            <sw-modal v-if="showOptionDeleteModal"
                      :title="$tc('swag-customized-products.detail.tabGeneral.cardOption.titleModalDelete')"
                      variant="small"
                      @modal-close="onOptionCloseDeleteModal">

                {% block swag_customized_products_detail_base_option_delete_modal_text %}
                    <p class="swag-customized-products-detail-base__confirm-delete-text">
                        {{ getOptionsDeleteModalText }}
                    </p>
                {% endblock %}

                {% block swag_customized_products_detail_base_option_delete_modal_footer %}
                    <template #modal-footer>

                        {% block swag_customized_products_detail_base_option_delete_modal_cancel %}
                            <sw-button size="small"
                                       @click="onOptionCloseDeleteModal">
                                {{ $tc('global.default.cancel') }}
                            </sw-button>
                        {% endblock %}

                        {% block swag_customized_products_detail_base_option_delete_modal_confirm %}
                            {% block swag_customized_products_detail_base_option_delete_modal_confirm_single %}
                                <template v-if="showOptionDeleteModal === 'bulk'">
                                    <sw-button size="small"
                                               variant="primary"
                                               @click="onOptionConfirmBulkDelete">
                                        {{ $tc('global.default.delete') }}
                                    </sw-button>
                                </template>
                            {% endblock %}

                            {% block swag_customized_products_detail_base_option_delete_modal_confirm_bulk %}
                                <template v-else>
                                    <sw-button size="small"
                                               variant="primary"
                                               @click="onOptionConfirmDelete">
                                        {{ $tc('global.default.delete') }}
                                    </sw-button>
                                </template>
                            {% endblock %}
                        {% endblock %}
                    </template>
                {% endblock %}
            </sw-modal>
        {% endblock %}

        <swag-customized-products-exclusion-list
            v-if="showExclusionList"
            :context="versionContext"
            :templateId="template.id">
        </swag-customized-products-exclusion-list>

    </div>
{% endblock %}
