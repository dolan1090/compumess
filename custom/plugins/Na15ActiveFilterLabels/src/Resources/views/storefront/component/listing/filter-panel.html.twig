{% sw_extends '@Storefront/storefront/component/listing/filter-panel.html.twig' %}

{% block component_filter_panel_item_properties %}
	{# @var properties \Shopware\Core\Framework\DataAbstractionLayer\Search\AggregationResult\Metric\EntityResult #}
	{% set properties = listing.aggregations.get('properties') %}

	{% if not properties.entities is empty %}
		{% for property in properties.entities %}
			{% if config('Na15ActiveFilterLabels.config.showPropertyName') %}
				{% set propertyName = property.translated.name ~ ":" %}
			{% else %}
				{% set propertyName = "" %}
			{% endif %}

			{% if config('Na15ActiveFilterLabels.config.showPropertyDescription') %}
				{% set propertyDescription = property.translated.description %}
			{% else %}
				{% set propertyDescription = "" %}
			{% endif %}

			{% sw_include '@Storefront/storefront/component/listing/filter/filter-property-select.html.twig' with {
                elements: property.options,
                sidebar: sidebar,
                name: 'properties',
                displayName: property.translated.name,
                displayType: property.displayType,
                pluginSelector: 'filter-property-select',
                propertyName: propertyName,
                propertyDescription: propertyDescription,
            } %}
		{% endfor %}
	{% endif %}
{% endblock %}

{% block component_filter_panel_item_manufacturer %}
	{# @var manufacturers \Shopware\Core\Framework\DataAbstractionLayer\Search\AggregationResult\Metric\EntityResult #}
	{% set manufacturers = listing.aggregations.get('manufacturer') %}
	{% if not manufacturers.entities is empty %}
		{% set manufacturersSorted = manufacturers.entities|sort((a, b) => a.translated.name|lower <=> b.translated.name|lower) %}
		{% if config('Na15ActiveFilterLabels.config.showPropertyName') %}
			{% set propertyName = 'listing.filterManufacturerDisplayName'|trans|sw_sanitize ~ ":" %}
		{% else %}
			{% set propertyName = "" %}
		{% endif %}

		{% sw_include '@Storefront/storefront/component/listing/filter/filter-multi-select.html.twig' with {
            elements: manufacturersSorted,
            sidebar: sidebar,
            name: 'manufacturer',
            displayName: 'listing.filterManufacturerDisplayName'|trans|sw_sanitize,
            propertyName: propertyName,
        } %}
	{% endif %}
{% endblock %}
