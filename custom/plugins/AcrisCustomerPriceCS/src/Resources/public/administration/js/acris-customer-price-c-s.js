!function(e){var r={};function t(i){if(r[i])return r[i].exports;var c=r[i]={i:i,l:!1,exports:{}};return e[i].call(c.exports,c,c.exports,t),c.l=!0,c.exports}t.m=e,t.c=r,t.d=function(e,r,i){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var c in e)t.d(i,c,function(r){return e[r]}.bind(null,c));return i},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p=(window.__sw__.assetPath + '/bundles/acriscustomerpricecs/'),t(t.s="n3S8")}({"7Fp0":function(e,r,t){},BsCe:function(e,r){Shopware.Module.register("acris-customer-prices-customer-tab",{routeMiddleware:function(e,r){"sw.customer.detail"===r.name&&r.children.push({name:"acris.customer.prices.customer.tab",path:"/sw/customer/detail/:id/customer-price",component:"acris-customer-prices-customer-tab",meta:{parentPath:"sw.customer.index"}}),e(r)}})},HXgV:function(e,r){var t=Shopware.Component;Shopware.Data.Criteria;t.extend("acris-one-to-many-grid","sw-one-to-many-grid",{methods:{load:function(){var e=this;return this.repository=this.repositoryFactory.create(this.collection.entity,this.collection.source),this.repository.search(this.result.criteria,this.result.context).then((function(r){e.applyResult(r)}))},paginate:function(e){return this.result.criteria.setPage(e.page),this.result.criteria.setLimit(e.limit),this.load()}}})},K3lb:function(e,r,t){var i=t("th+M");i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,t("P8hj").default)("229e0223",i,!0,{})},LvN7:function(e,r,t){},P8hj:function(e,r,t){"use strict";function i(e,r){for(var t=[],i={},c=0;c<r.length;c++){var n=r[c],s=n[0],o={id:e+":"+c,css:n[1],media:n[2],sourceMap:n[3]};i[s]?i[s].parts.push(o):t.push(i[s]={id:s,parts:[o]})}return t}t.r(r),t.d(r,"default",(function(){return _}));var c="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!c)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var n={},s=c&&(document.head||document.getElementsByTagName("head")[0]),o=null,a=0,l=!1,u=function(){},d=null,m="data-vue-ssr-id",p="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function _(e,r,t,c){l=t,d=c||{};var s=i(e,r);return f(s),function(r){for(var t=[],c=0;c<s.length;c++){var o=s[c];(a=n[o.id]).refs--,t.push(a)}r?f(s=i(e,r)):s=[];for(c=0;c<t.length;c++){var a;if(0===(a=t[c]).refs){for(var l=0;l<a.parts.length;l++)a.parts[l]();delete n[a.id]}}}}function f(e){for(var r=0;r<e.length;r++){var t=e[r],i=n[t.id];if(i){i.refs++;for(var c=0;c<i.parts.length;c++)i.parts[c](t.parts[c]);for(;c<t.parts.length;c++)i.parts.push(b(t.parts[c]));i.parts.length>t.parts.length&&(i.parts.length=t.parts.length)}else{var s=[];for(c=0;c<t.parts.length;c++)s.push(b(t.parts[c]));n[t.id]={id:t.id,refs:1,parts:s}}}}function h(){var e=document.createElement("style");return e.type="text/css",s.appendChild(e),e}function b(e){var r,t,i=document.querySelector("style["+m+'~="'+e.id+'"]');if(i){if(l)return u;i.parentNode.removeChild(i)}if(p){var c=a++;i=o||(o=h()),r=g.bind(null,i,c,!1),t=g.bind(null,i,c,!0)}else i=h(),r=v.bind(null,i),t=function(){i.parentNode.removeChild(i)};return r(e),function(i){if(i){if(i.css===e.css&&i.media===e.media&&i.sourceMap===e.sourceMap)return;r(e=i)}else t()}}var P,y=(P=[],function(e,r){return P[e]=r,P.filter(Boolean).join("\n")});function g(e,r,t,i){var c=t?"":i.css;if(e.styleSheet)e.styleSheet.cssText=y(r,c);else{var n=document.createTextNode(c),s=e.childNodes;s[r]&&e.removeChild(s[r]),s.length?e.insertBefore(n,s[r]):e.appendChild(n)}}function v(e,r){var t=r.css,i=r.media,c=r.sourceMap;if(i&&e.setAttribute("media",i),d.ssrId&&e.setAttribute(m,r.id),c&&(t+="\n/*# sourceURL="+c.sources[0]+" */",t+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(c))))+" */"),e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},WfvR:function(e,r,t){var i=t("7Fp0");i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,t("P8hj").default)("c16633ba",i,!0,{})},aaSf:function(e,r,t){},bggN:function(e,r,t){var i=t("aaSf");i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,t("P8hj").default)("37aee196",i,!0,{})},kxIJ:function(e,r,t){var i=t("LvN7");i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,t("P8hj").default)("3410a79c",i,!0,{})},l1FU:function(e,r){Shopware.Module.register("acris-customer-prices-product-tab",{routeMiddleware:function(e,r){"sw.product.detail"===r.name&&r.children.push({name:"acris.customer.prices.product.tab",path:"/sw/product/detail/:id/customer-prices",component:"acris-customer-prices-product-tab",meta:{parentPath:"sw.product.index"}}),e(r)}})},mRvz:function(e){e.exports=JSON.parse('{"acris-customer-price":{"general":{"mainMenuItemGeneral":"Kundenspezifische Preise","descriptionTextModule":"Konfigurieren Sie kundenspezifische Preise.","placeholderSearchBar":"Kundenspezifische Preise suchen"},"list":{"textHeadline":"Kundenspezifische Preise","buttonAdd":"Kundenspezifischen Preis hinzufügen","emptyAcrisPrices":"Es gibt keine zugewiesenen kundenspezifischen Preise","acrisPricesLabel":"Nettopreis: {netPrice}, Bruttopreis: {grossPrice}","columnProductNumber":"Produktnummer","columnCustomerNumber":"Kundennummer","columnCustomerEmail":"Kunden-E-Mail","columnProduct":"Produktname","columnCustomer":"Kundenname","columnListPrice":"Preis","columnRules":"Regeln","columnActive":"Aktiv","contextMenuView":"Siehe","contextMenuDelete":"Löschen","contentEmpty":"Es sind noch keine kundenspezifischen Preise vorhanden.","contextMenuDuplicate":"Duplizieren","contextMenuEdit":"Bearbeiten","messageEmpty":"Es ist noch kein kundenspezifischer Preis vorhanden.","messageSaveError":"Der kundenspezifische Preis konnte nicht gespeichert werden.","messageSaveSuccess":"Der kundenspezifische Preis wurde gespeichert.","modalTitleDelete":"Kundenspezifische Preise löschen","textDeleteConfirm":"Sind Sie sicher, dass Sie den kundenspezifischen Preis löschen möchten?","buttonCancel":"Abbrechen","buttonDelete":"Löschen","titleSidebarItemRefresh":"Aktualisieren","titleSidebarItemFilter":"Filter"},"detail":{"textHeadline":"Kundenspezifischen Preis konfigurieren","buttonSave":"Speichern","buttonCancel":"Abbrechen","cardGeneral":"Allgemein","cardDisplayConditions":"Bedingungen anzeigen","cardAdvancedPrice":"Preise","fieldTitleLabelProduct":"Produkt","fieldTitlePlaceholderProduct":"Produkt eingeben...","fieldTitleHelpTextProduct":"Der kundenspezifische Preise wird für das zugewiesene Produkt berechnet.","fieldTitleLabelCustomer":"Kunde","fieldTitlePlaceholderCustomer":"Kunde eingeben...","fieldTitleHelpTextCustomer":"Der kundenspezifische Preis wird für das zugewiesene Produkt berechnet, wenn der zugewiesene Kunde im Store eingeloggt ist","fieldTitleLabelActive":"Aktiv","fieldTitleHelpTextActive":"Wenn aktiv, wird der kundenspezifische Preis für das zugewiesene Produkt und den Kunden berechnet.","fieldTitleLabelActiveFrom":"Aktiv von","fieldTitlePlaceholderActiveFrom":"Aktiv von Datum eingeben...","fieldTitleLabelActiveUntil":"Aktiv bis","fieldTitlePlaceholderActiveUntil":"Aktiv bis Datum eingeben...","advancedListPriceLabel":"Streichpreis","labelRegulationPrice":"Günstigster Preis (letzte 30 Tage)","linkProduct":"Ausgewähltes Produkt öffnen","linkCustomer":"Ausgewählten Kunden öffnen","inputListPriceTypeLabel":"Listenpreis Typ","inputListPriceTypePlaceholder":"Listenpreis Typ auswählen...","inputListPriceTypeHelpText":"Der Listenpreis wird für das zugewiesene Produkt im Schaufenster auf der Grundlage der gewählten Option angezeigt.","rulesSelectFieldLabel":"Zusätzliche Regeln","rulesSelectFieldPlaceholder":"Zusätzliche Regeln auswählen...","rulesSelectFieldHelpText":"Die Preis wird aktiv, wenn eine der angegebenen Regeln übereinstimmt (ODER-Verknüpfung). Wird keine Regel ausgewählt, ist der Preis immer für den Kunden aktiv.","replaceOption":"Produkt Streichpreis immer ersetzen, auch wenn hier keiner angegeben wurde","ifEmptyUseOriginalOption":"Wenn hier kein Streichpreis angegeben wurde, den ursprünglichen Streichpreis verwenden","ifBothEmptyUseNormalPriceOption":"Wenn hier kein Streichpreis angegeben wurde und das Produkt keinen Streichpreis besitzt, den ursprünglichen Produktpreis als Streichpreis verwenden","customerPriceExistError":"Der Kundenpreis mit zugeordnetem Produkt und Kunde existiert bereits.\\nBitte weisen Sie ein anderes Produkt oder einen anderen Kunden zu.","titleSaveError":"Fehler","titleSaveSuccess":"Erfolg","messageSaveError":"Der kundenspezifische Preis konnte nicht gespeichert werden.","messageSaveSuccess":"Der kundenspezifische Preis wurde gespeichert."}},"acris-customer-prices-product-tab":{"tabTitle":"Kundenspezifische Preise","cardCustomerPrice":"Konfiguration der Preise","contextMenuEdit":"Bearbeiten","contextMenuDelete":"Löschen","modalTitleDeleteProduct":"Kundenpreis löschen","textDeleteProductConfirm":"Möchten Sie den Kundenpreis löschen?","buttonAddCustomerPrice":"Kundenspezifischer Preis","buttonCancel":"Abbrechen","buttonDelete":"Löschen","titleModalProducts":"Kundenspezifische Preise","modalProductCancelButton":"Abbrechen","modalProductApplyButton":"Speichern"},"acris-customer-prices-customer-tab":{"tabTitle":"Kundenspezifische Preise","cardCustomerPrice":"Konfiguration der Preise","contextMenuEdit":"Bearbeiten","contextMenuDelete":"Löschen","modalTitleDeleteProduct":"Kundenpreis löschen","textDeleteProductConfirm":"Möchten Sie den Kundenpreis löschen?","buttonAddCustomerPrice":"Kundenspezifischer Preis","buttonCancel":"Abbrechen","buttonDelete":"Löschen","titleModalProducts":"Kundenspezifische Preise","modalProductCancelButton":"Abbrechen","modalProductApplyButton":"Speichern"}}')},n3S8:function(e,r,t){"use strict";t.r(r);t("bggN");var i=Shopware,c=i.Component,n=i.Mixin,s=Shopware.Data.Criteria;c.register("acris-customer-price-list",{template:'{% block acris_customer_price_list %}\r\n<sw-page class="acris-customer-price-list">\r\n    {% block acris_customer_price_list_search_bar %}\r\n        <template slot="search-bar">\r\n            <sw-search-bar initialSearchType="Customer price"\r\n                           :placeholder="$tc(\'acris-customer-price.general.placeholderSearchBar\')"\r\n                           :initialSearch="term"\r\n                           @search="onSearch" id="customerPrice">\r\n            </sw-search-bar>\r\n        </template>\r\n    {% endblock %}\r\n\r\n    {% block acris_customer_price_list_smart_bar_header %}\r\n        <template slot="smart-bar-header">\r\n            {% block acris_customer_price_list_smart_bar_header_title %}\r\n                <h2>\r\n                    {% block acris_customer_price_list_smart_bar_header_title_text %}\r\n                        {{ $tc(\'acris-customer-price.list.textHeadline\') }}\r\n                        {% endblock %}\r\n\r\n                        {% block acris_customer_price_list_smart_bar_header_amount %}\r\n                        <span v-if="!isLoading" class="sw-page__smart-bar-amount">\r\n                        ({{ total }})\r\n                        </span>\r\n                    {% endblock %}\r\n                </h2>\r\n            {% endblock %}\r\n        </template>\r\n    {% endblock %}\r\n\r\n    {% block acris_customer_price_list_smart_bar_actions %}\r\n    <template slot="smart-bar-actions">\r\n        {% block acris_customer_price_list_smart_bar_actions_add %}\r\n        <sw-button variant="primary" :routerLink="{ name: \'acris.customer.price.create\' }">\r\n            {{ $tc(\'acris-customer-price.list.buttonAdd\') }}\r\n        </sw-button>\r\n        {% endblock %}\r\n    </template>\r\n    {% endblock %}\r\n\r\n    {% block acris_customer_price_list_cardview %}\r\n    <template slot="content">\r\n        <div class="acris-customer-price-list__content">\r\n            {% block acris_customer_price_list_content %}\r\n            <sw-entity-listing class="acris-customer-price-list-grid"\r\n                               v-if="items && total > 0"\r\n                               :items="items"\r\n                               :repository="entityRepository"\r\n                               detailRoute="acris.customer.price.detail"\r\n                               :showSeleciton="true"\r\n                               :isLoading="isLoading"\r\n                               :columns="columns">\r\n\r\n                {% block acris_customer_price_list_grid_columns_rules %}\r\n                <template #column-rules="{ item }">\r\n                    <div v-bind:class="{ \'acris-no-rule\' : item.rules.length == 0}">\r\n                        <sw-label\r\n                                v-for="rule in item.rules"\r\n                                appearance="default"\r\n                                size="default">\r\n                            {{ rule.name }}\r\n                        </sw-label>\r\n                    </div>\r\n                </template>\r\n                {% endblock %}\r\n\r\n                {% block acris_customer_price_list_grid_columns_active %}\r\n                <template #column-active="{ item, isInlineEdit }">\r\n                    {% block acris_customer_price_list_grid_columns_active_inline_edit %}\r\n                    <template v-if="isInlineEdit">\r\n                        <sw-checkbox-field v-model="item.active"></sw-checkbox-field>\r\n                    </template>\r\n                    {% endblock %}\r\n\r\n                    {% block acris_customer_price_list_grid_columns_active_content %}\r\n                    <template v-else>\r\n                        <sw-icon v-if="item.active" name="regular-checkmark-xs" small\r\n                                 class="is--active"></sw-icon>\r\n                        <sw-icon v-else name="small-default-x-line-medium" small class="is--inactive"></sw-icon>\r\n                    </template>\r\n                    {% endblock %}\r\n                </template>\r\n                {% endblock %}\r\n\r\n                {% block acris_customer_price_list_grid_columns_product_name %}\r\n                <template #column-product="{ item, isInlineEdit }">\r\n                    {% block acris_customer_price_list_grid_columns_product_inline_edit %}\r\n                    <template v-if="item.product">\r\n                        <sw-product-variant-info :variations="item.product.variation">\r\n                            <a @click="onEditCustomerPrice(item.id)">{{ item.product.translated.name || item.product.name }}</a>\r\n                        </sw-product-variant-info>\r\n                    </template>\r\n                    <template v-else>\r\n                        <a @click="onEditCustomerPrice(item.id)">{{ item.productId }}</a>\r\n                    </template>\r\n                    {% endblock %}\r\n                </template>\r\n                {% endblock %}\r\n\r\n                {% block acris_customer_price_list_grid_columns_customer %}\r\n                    <template #column-customer="{ item, isInlineEdit }">\r\n                        {% block acris_customer_price_list_grid_columns_customer_inline_edit %}\r\n                            <template v-if="item.customer">\r\n                                <a @click="onEditCustomerPrice(item.id)">{{ item.customer.firstName }} {{ item.customer.lastName }}</a>\r\n                            </template>\r\n                        {% endblock %}\r\n                    </template>\r\n                {% endblock %}\r\n\r\n                {% block acris_customer_price_list_grid_columns_acris_prices %}\r\n                    <template #column-acrisPrices="{ item, isInlineEdit }">\r\n                        {% block acris_customer_price_list_grid_columns_acris_prices_inline_edit %}\r\n                            <template v-if="item.acrisPrices && item.acrisPrices.length > 0 && item.acrisPrices[0] && item.acrisPrices[0].price[0]">\r\n                                <a @click="onEditCustomerPrice(item.id)">{{ $tc(\'acris-customer-price.list.acrisPricesLabel\', 0, { netPrice: item.acrisPrices[0].price[0].net, grossPrice: item.acrisPrices[0].price[0].gross }) }}</a>\r\n                            </template>\r\n                            <template v-else>\r\n                                {{ $tc(\'acris-customer-price.list.emptyAcrisPrices\') }}\r\n                            </template>\r\n                        {% endblock %}\r\n                    </template>\r\n                {% endblock %}\r\n\r\n                {% block acris_customer_price_list_grid_columns_actions %}\r\n                <template #more-actions="{ item }">\r\n                    {% block acris_customer_price_list_grid_columns_actions_duplicate %}\r\n                    <sw-context-menu-item\r\n                        @click="onDuplicate(item)">\r\n                        {{ $tc(\'acris-customer-price.list.contextMenuDuplicate\') }}\r\n                    </sw-context-menu-item>\r\n                    {% endblock %}\r\n                </template>\r\n                {% endblock %}\r\n\r\n                <template #pagination>\r\n                    {% block sw_order_list_grid_pagination %}\r\n                    <sw-pagination :page="page"\r\n                                   :limit="limit"\r\n                                   :total="total"\r\n                                   :total-visible="7"\r\n                                   @page-change="onPageChange">\r\n                    </sw-pagination>\r\n                    {% endblock %}\r\n                </template>\r\n\r\n            </sw-entity-listing>\r\n            {% endblock %}\r\n\r\n            {% block acris_customer_price_list_empty_state %}\r\n            <sw-empty-state v-if="!isLoading && total === 0" :title="$tc(\'acris-customer-price.list.contentEmpty\')"></sw-empty-state>\r\n            {% endblock %}\r\n\r\n        </div>\r\n    </template>\r\n    {% endblock %}\r\n\r\n    {% block acris_customer_price_list_sidebar %}\r\n    <template #sidebar>\r\n        <sw-sidebar class="acris-customer-price-list__sidebar">\r\n            {% block acris_customer_price_list_sidebar_item %}\r\n            <sw-sidebar-item\r\n                icon="regular-undo"\r\n                :title="$tc(\'acris-customer-price.list.titleSidebarItemRefresh\')"\r\n                @click="onRefresh">\r\n            </sw-sidebar-item>\r\n            {% endblock %}\r\n        </sw-sidebar>\r\n    </template>\r\n    {% endblock %}\r\n\r\n</sw-page>\r\n{% endblock %}\r\n',inject:["repositoryFactory"],mixins:[n.getByName("listing"),n.getByName("notification"),n.getByName("placeholder")],data:function(){return{items:null,isLoading:!1,showDeleteModal:!1,repository:null,total:0}},metaInfo:function(){return{title:this.$createTitle()}},computed:{entityRepository:function(){return this.repositoryFactory.create("acris_customer_price")},productRepository:function(){return this.repositoryFactory.create("product")},customerPriceCriteria:function(){var e=new s(this.page,this.limit);return e.setTerm(this.term),e.addAssociation("product"),e.addAssociation("product.options.group"),e.addAssociation("customer"),e.addAssociation("rules"),e.addAssociation("acrisPrices"),e},columns:function(){return this.getColumns()}},methods:{getList:function(){var e=this;this.isLoading=!0,this.entityRepository.search(this.customerPriceCriteria,Shopware.Context.api).then((function(r){return e.total=r.total,e.items=r,e.items.forEach((function(r){r.product&&r.product.parentId&&e.productRepository.get(r.product.parentId,Shopware.Context.api).then((function(e){r.product.name=e.name,r.product.translated.name=e.translated.name}))})),e.isLoading=!1,r})).catch((function(){e.isLoading=!1}))},onDelete:function(e){this.showDeleteModal=e},onCloseDeleteModal:function(){this.showDeleteModal=!1},onEditCustomerPrice:function(e){this.$router.push({name:"acris.customer.price.detail",params:{id:e}})},getColumns:function(){return[{property:"product.productNumber",inlineEdit:"string",label:"acris-customer-price.list.columnProductNumber",routerLink:"acris.customer.price.detail",allowResize:!0,primary:!0},{property:"product",inlineEdit:"string",label:"acris-customer-price.list.columnProduct",routerLink:"acris.customer.price.detail",allowResize:!0,primary:!0},{property:"customer.customerNumber",inlineEdit:"string",label:"acris-customer-price.list.columnCustomerNumber",routerLink:"acris.customer.price.detail",allowResize:!0,primary:!0},{property:"customer.email",inlineEdit:"string",label:"acris-customer-price.list.columnCustomerEmail",routerLink:"acris.customer.price.detail",allowResize:!0,primary:!0},{property:"customer",inlineEdit:"string",label:"acris-customer-price.list.columnCustomer",routerLink:"acris.customer.price.detail",allowResize:!0,primary:!0},{property:"acrisPrices",inlineEdit:"string",label:"acris-customer-price.list.columnListPrice",routerLink:"acris.customer.price.detail",allowResize:!0},{property:"rules",dataIndex:"rules",label:"acris-customer-price.list.columnRules",sortable:!1,allowResize:!0,multiLine:!0},{property:"active",label:"acris-customer-price.list.columnActive",inlineEdit:"boolean",width:"80px",allowResize:!0,align:"center"}]},onDuplicate:function(e){var r=this;this.entityRepository.clone(e.id,Shopware.Context.api).then((function(t){r.reloadEntity(e,t)}))},reloadEntity:function(e,r){var t=this;this.entityRepository.get(e.id,Shopware.Context.api,this.customerPriceCriteria).then((function(i){t.item=i,t.item.rules=e.rules,t.entityRepository.save(t.item,Shopware.Context.api).then((function(){t.$router.push({name:"acris.customer.price.detail",params:{id:r.id}})}))}))}}});var o=Shopware.Component,a=Shopware.Utils;o.extend("acris-customer-price-create","acris-customer-price-detail",{template:"",beforeRouteEnter:function(e,r,t){e.name.includes("acris.customer.price.create")&&!e.params.id&&(e.params.id=a.createId(),e.params.newItem=!0),t()},methods:{getEntity:function(){this.item=this.repository.create(Shopware.Context.api),this.item.listPriceType="replace",this.item.active=!0},createdComponent:function(){this.$super("createdComponent")},saveFinish:function(){this.isSaveSuccessful=!1,this.$router.push({name:"acris.customer.price.detail",params:{id:this.item.id}})},onClickSave:function(){var e=this;this.isLoading=!0;var r=this.$tc("acris-customer-price.detail.titleSaveError"),t=this.$tc("acris-customer-price.detail.messageSaveError"),i=this.$tc("acris-customer-price.detail.titleSaveSuccess"),c=this.$tc("acris-customer-price.detail.messageSaveSuccess");this.item.acrisPrices.forEach((function(e){e.price&&e.price.forEach((function(e){e.listPrice&&(e.listPrice.net<=0||e.listPrice.gross<=0)&&(e.listPrice=null)}))})),this.repository.save(this.item,Shopware.Context.api).then((function(){e.isLoading=!1,e.createNotificationSuccess({title:i,message:c}),e.$router.push({name:"acris.customer.price.detail",params:{id:e.item.id}})})).catch((function(){e.isLoading=!1,e.createNotificationError({title:r,message:t})}))}}});t("WfvR");function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,i)}return t}function d(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?u(Object(t),!0).forEach((function(r){m(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):u(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function m(e,r,t){return(r=function(e){var r=function(e,r){if("object"!==l(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,r||"default");if("object"!==l(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"===l(r)?r:String(r)}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function p(e){return function(e){if(Array.isArray(e))return _(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,r){if(!e)return;if("string"==typeof e)return _(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return _(e,r)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,i=new Array(r);t<r;t++)i[t]=e[t];return i}var f=Shopware.Component,h=Shopware.Mixin,b=Shopware.Data.Criteria;f.register("acris-customer-price-detail",{template:'{% block acris_customer_price_detail %}\r\n<sw-page class="acris-customer-price-detail" v-if="item && defaultCustomCurrency">\r\n\r\n    {% block acris_customer_price_detail_smart_bar_header %}\r\n    <template slot="smart-bar-header">\r\n        {% block acris_customer_price_detail_smart_bar_header_title %}\r\n        <h2>{{ $tc(\'acris-customer-price.detail.textHeadline\') }}</h2>\r\n        {% endblock %}\r\n    </template>\r\n    {% endblock %}\r\n\r\n    {% block acris_customer_price_detail_smart_bar_actions %}\r\n    <template slot="smart-bar-actions">\r\n        {% block acris_customer_price_detail_smart_bar_actions_cancel %}\r\n        <sw-button :disabled="item.isLoading" :routerLink="{ name: \'acris.customer.price.index\' }">\r\n            {{ $tc(\'acris-customer-price.detail.buttonCancel\') }}\r\n        </sw-button>\r\n        {% endblock %}\r\n\r\n        {% block acris_customer_price_detail_smart_bar_actions_save %}\r\n        <sw-button-process\r\n            class="acris-customer-price-detail__save-action"\r\n            :isLoading="isLoading"\r\n            :processSuccess="processSuccess"\r\n            variant="primary"\r\n            :disabled="item.isLoading || !item.productId || !item.customerId || customerPriceExist"\r\n            @process-finish="saveFinish"\r\n            @click="onClickSave">\r\n            {{ $tc(\'acris-customer-price.detail.buttonSave\') }}\r\n        </sw-button-process>\r\n        {% endblock %}\r\n    </template>\r\n    {% endblock %}\r\n\r\n\r\n    {% block acris_customer_price_detail_content %}\r\n    <sw-card-view slot="content">\r\n\r\n        {% block acris_customer_price_detail_content_card %}\r\n        <sw-card :isLoading="isLoading" v-if="item"\r\n                 :title="$tc(\'acris-customer-price.detail.cardGeneral\')">\r\n\r\n            <sw-alert v-if="customerPriceExist" variant="error">\r\n                {{ $tc(\'acris-customer-price.detail.customerPriceExistError\') }}\r\n            </sw-alert>\r\n\r\n            {% block acris_customer_price_detail_product_select %}\r\n            <sw-entity-single-select\r\n                v-model="item.productId"\r\n                entity="product"\r\n                :label="$tc(\'acris-customer-price.detail.fieldTitleLabelProduct\')"\r\n                :helpText="$tc(\'acris-customer-price.detail.fieldTitleHelpTextProduct\')"\r\n                :placeholder="$tc(\'acris-customer-price.detail.fieldTitlePlaceholderProduct\')"\r\n                @change="onProductChange"\r\n                required\r\n                :criteria="productCriteria"\r\n                :context="productSelectContext">\r\n\r\n                {% block acris_customer_price_detail_product_variant_label %}\r\n                <template #selection-label-property="{ item }">\r\n                    <sw-product-variant-info :variations="item.variation">\r\n                        {{ item.productNumber }} - {{ item.translated.name || item.name }}\r\n                    </sw-product-variant-info>\r\n                </template>\r\n                {% endblock %}\r\n\r\n                {% block acris_customer_price_detail_product_select_result_item %}\r\n                    <template #result-item="{ item, index }">\r\n                        <li is="sw-select-result" v-bind="{ item, index }">\r\n                            {% block acris_customer_price_detail_single_select_base_results_list_result_label %}\r\n                                <span class="sw-select-result__result-item-text">\r\n                              <sw-product-variant-info :variations="item.variation">\r\n                                    {{ item.productNumber }} - {{ item.translated.name || item.name }}\r\n                              </sw-product-variant-info>\r\n                         </span>\r\n                            {% endblock %}\r\n\r\n                        </li>\r\n                    </template>\r\n                {% endblock %}\r\n            </sw-entity-single-select>\r\n            {% endblock %}\r\n\r\n            {% block acris_customer_price_detail_product_form_link %}\r\n            <sw-container\r\n                columns="1fr"\r\n                v-if="item.productId"\r\n                justify="end"\r\n                class="sw-product-price-form__links acris-customer-price-detail-select-field-link"\r\n            >\r\n                {% block acris_customer_price_detail_product_form_product_link %}\r\n                <router-link\r\n                    :to="{ name: \'sw.product.detail\', params: { id: item.productId } }"\r\n                    class="sw-card__quick-link"\r\n                >\r\n                    {{ $tc(\'acris-customer-price.detail.linkProduct\') }} <sw-icon\r\n                        name="regular-long-arrow-right"\r\n                        small\r\n                    />\r\n                </router-link>\r\n                {% endblock %}\r\n\r\n            </sw-container>\r\n            {% endblock %}\r\n\r\n            {% block acris_customer_price_detail_customer_select %}\r\n                <sw-entity-single-select\r\n                    v-model="item.customerId"\r\n                    entity="customer"\r\n                    @change="onCustomerChange"\r\n                    required\r\n                    :label="$tc(\'acris-customer-price.detail.fieldTitleLabelCustomer\')"\r\n                    :helpText="$tc(\'acris-customer-price.detail.fieldTitleHelpTextCustomer\')"\r\n                    :placeholder="$tc(\'acris-customer-price.detail.fieldTitlePlaceholderCustomer\')">\r\n\r\n                    {% block acris_customer_price_detail_customer_variant_label %}\r\n                        <template #selection-label-property="{ item }">\r\n                            {{ item.customerNumber }} - {{ item.email }} - {{ item.firstName }} {{ item.lastName }}\r\n                        </template>\r\n                    {% endblock %}\r\n\r\n                    {% block acris_customer_price_detail_customer_select_result_item %}\r\n                        <template #result-item="{ item, index }">\r\n                            <li is="sw-select-result" v-bind="{ item, index }">\r\n                                {% block acris_customer_price_detail_single_select_customer_base_results_list_result_label %}\r\n                                    <span class="sw-select-result__result-item-text">\r\n                                        {{ item.customerNumber }} - {{ item.email }} - {{ item.firstName }} {{ item.lastName }}\r\n                                    </span>\r\n                                {% endblock %}\r\n                            </li>\r\n                        </template>\r\n                    {% endblock %}\r\n                </sw-entity-single-select>\r\n            {% endblock %}\r\n\r\n            {% block acris_customer_price_detail_customer_form_link %}\r\n            <sw-container\r\n                columns="1fr"\r\n                v-if="item.customerId"\r\n                justify="end"\r\n                class="sw-product-price-form__links acris-customer-price-detail-select-field-link"\r\n            >\r\n                {% block acris_customer_price_detail_customer_form_customer_link %}\r\n                <router-link\r\n                    :to="{ name: \'sw.customer.detail\', params: { id: item.customerId } }"\r\n                    class="sw-card__quick-link"\r\n                >\r\n                    {{ $tc(\'acris-customer-price.detail.linkCustomer\') }} <sw-icon\r\n                        name="regular-long-arrow-right"\r\n                        small\r\n                    />\r\n                </router-link>\r\n                {% endblock %}\r\n\r\n            </sw-container>\r\n            {% endblock %}\r\n\r\n            {% block acris_customer_price_detail_content_active_checkbox_select %}\r\n                <sw-field v-model="item.active"\r\n                          type="switch"\r\n                          class="acris-customer-price-detail__item_active"\r\n                          :label="$tc(\'acris-customer-price.detail.fieldTitleLabelActive\')"\r\n                          :helpText="$tc(\'acris-customer-price.detail.fieldTitleHelpTextActive\')">\r\n                </sw-field>\r\n            {% endblock %}\r\n\r\n            {% block acris_customer_price_detail_base_active_container %}\r\n                <sw-container\r\n                    columns="1fr 1fr"\r\n                    gap="0 32px"\r\n                >\r\n\r\n                    {% block acris_customer_price_detail_active_from %}\r\n                        <sw-datepicker\r\n                            v-model="item.activeFrom"\r\n                            class="acris-customer-price-detail-base__field-active-from"\r\n                            date-type="datetime-local"\r\n                            :label="$tc(\'acris-customer-price.detail.fieldTitleLabelActiveFrom\')"\r\n                            :placeholder-text="$tc(\'acris-customer-price.detail.fieldTitlePlaceholderActiveFrom\')"\r\n                        />\r\n                    {% endblock %}\r\n\r\n                    {% block acris_customer_price_detail_active_until %}\r\n                        <sw-datepicker\r\n                            v-model="item.activeUntil"\r\n                            class="acris-customer-price-detail-base__field-active-until"\r\n                            date-type="datetime-local"\r\n                            :label="$tc(\'acris-customer-price.detail.fieldTitleLabelActiveUntil\')"\r\n                            :placeholder-text="$tc(\'acris-customer-price.detail.fieldTitlePlaceholderActiveUntil\')"\r\n                        />\r\n                    {% endblock %}\r\n\r\n                </sw-container>\r\n            {% endblock %}\r\n\r\n            {% block acris_customer_price_detail_content_list_price_type %}\r\n                <sw-select-field\r\n                    :label="$tc(\'acris-customer-price.detail.inputListPriceTypeLabel\')"\r\n                    :placeholder="$tc(\'acris-customer-price.detail.inputListPriceTypePlaceholder\')"\r\n                    :helpText="$tc(\'acris-customer-price.detail.inputListPriceTypeHelpText\')"\r\n                    v-model="item.listPriceType">\r\n                    <option v-for="option in listPriceTypes"\r\n                            :key="option.value"\r\n                            :value="option.value">\r\n                        {{ option.label }}\r\n                    </option>\r\n                </sw-select-field>\r\n            {% endblock %}\r\n\r\n        </sw-card>\r\n        {% endblock %}\r\n\r\n        {% block acris_customer_price_detail_content_card_conditions %}\r\n            <sw-card :isLoading="isLoading" v-if="item"\r\n                     :title="$tc(\'acris-customer-price.detail.cardDisplayConditions\')">\r\n\r\n                {% block acris_customer_price_detail_content_rules %}\r\n                    <sw-entity-many-to-many-select\r\n                        v-if="item && item.rules"\r\n                        :localMode="true"\r\n                        class="acris-customer-price-detail__rules"\r\n                        :label="$tc(\'acris-customer-price.detail.rulesSelectFieldLabel\')"\r\n                        :helpText="$tc(\'acris-customer-price.detail.rulesSelectFieldHelpText\')"\r\n                        :placeholder="$tc(\'acris-customer-price.detail.rulesSelectFieldPlaceholder\')"\r\n                        v-model="item.rules">\r\n                    </sw-entity-many-to-many-select>\r\n                {% endblock %}\r\n\r\n            </sw-card>\r\n        {% endblock %}\r\n\r\n        {% block sw_product_detail_prices_price_card %}\r\n        <sw-container\r\n            rows="auto"\r\n            columns="100%"\r\n            class="sw-product-detail-context-prices"\r\n        >\r\n            <sw-card\r\n                v-for="(priceGroup, key, index) in priceGroups"\r\n                class="context-price"\r\n                :class="getPriceRuleGroupClass(index)"\r\n                :title="$tc(\'acris-customer-price.detail.cardAdvancedPrice\')"\r\n                :is-loading="isLoading"\r\n                :large="true"\r\n            >\r\n\r\n                {% block sw_product_detail_prices_price_card_price_group_grid %}\r\n                <sw-data-grid\r\n                    v-if="priceGroup"\r\n                    :data-source="priceGroup.prices"\r\n                    :columns="pricesColumns"\r\n                    show-settings\r\n                    :show-selection="false"\r\n                    :compact-mode="true"\r\n                >\r\n                    {% block sw_product_detail_prices_price_card_price_group_grid_settings %}\r\n                    <template #additionalSettings>\r\n                        {% block sw_product_detail_prices_price_card_price_group_grid_settings_list_prices %}\r\n                        <sw-switch-field\r\n                            size="medium"\r\n                            :value="showListPrices[priceGroup.customerPriceId] !== false"\r\n                            no-margin-top\r\n                            :label="$tc(\'sw-product.prices.settingShowListPrices\')"\r\n                            @change="onChangeShowListPrices($event, priceGroup.customerPriceId)"\r\n                        />\r\n                        {% endblock %}\r\n                    </template>\r\n                    {% endblock %}\r\n\r\n                    {% block sw_product_detail_prices_price_card_price_group_grid_type %}\r\n                    <template\r\n                        slot="column-type"\r\n                        slot-scope="{ item, itemIndex, compact }"\r\n                    >\r\n                        <div class="sw-product-detail-context-prices__type-label">\r\n                            \r\n                            <label>{{ $tc(\'sw-product.advancedPrices.advancedListPricePriceLabel\') }}</label>\r\n                            \r\n                            <label v-if="showListPrices[priceGroup.customerPriceId] !== false">\r\n                                {{ $tc(\'acris-customer-price.detail.advancedListPriceLabel\') }}\r\n                            </label>\r\n                            \r\n                            <label v-if="showListPrices[priceGroup.customerPriceId] !== false">\r\n                                {{ $tc(\'acris-customer-price.detail.labelRegulationPrice\') }}\r\n                            </label>\r\n                        </div>\r\n                    </template>\r\n                    {% endblock %}\r\n\r\n                    {% block sw_product_detail_prices_price_card_price_group_grid_quantity_start %}\r\n                    <template\r\n                        slot="column-quantityStart"\r\n                        slot-scope="{ item, itemIndex, compact }"\r\n                    >\r\n                        {% block sw_product_detail_prices_price_card_price_group_grid_quantity_start_field %}\r\n                        <sw-field\r\n                            v-model="item.quantityStart"\r\n                            v-tooltip="getStartQuantityTooltip(itemIndex, item.quantityStart)"\r\n                            type="number"\r\n                            :name="`${item.customerPriceId}-${item.quantityStart}-quantityStart`"\r\n                            validation="required"\r\n                            :min="priceGroup.prices[itemIndex - 1] ? priceGroup.prices[itemIndex - 1].quantityEnd + 1 : 1"\r\n                            :max="item.quantityEnd ? item.quantityEnd : null"\r\n                            :size="compact ? \'small\' : \'default\'"\r\n                            :disabled="(itemIndex === 0 && item.quantityStart === 1)"\r\n                        />\r\n                        {% endblock %}\r\n                    </template>\r\n                    {% endblock %}\r\n\r\n                    {% block sw_product_detail_prices_price_card_price_group_grid_quantity_end %}\r\n                    <template\r\n                        slot="column-quantityEnd"\r\n                        slot-scope="{ item, itemIndex, compact }"\r\n                    >\r\n                        {% block sw_product_detail_prices_price_card_price_group_grid_quantity_end_field %}\r\n                        <sw-field\r\n                            v-model="item.quantityEnd"\r\n                            type="number"\r\n                            :validation="item.quantityEnd === null || item.quantityEnd > item.quantityStart"\r\n                            placeholder="∞"\r\n                            :name="`${item.customerPriceId}-${item.quantityStart}-quantityEnd`"\r\n                            :min="item.quantityStart"\r\n                            :max="priceGroup.prices[itemIndex + 1] ? priceGroup.prices[itemIndex + 1].quantityStart - 1 : null"\r\n                            :size="compact ? \'small\' : \'default\'"\r\n                            @change="onQuantityEndChange(item, priceGroup)"\r\n                        />\r\n                        {% endblock %}\r\n                    </template>\r\n                    {% endblock %}\r\n\r\n                    {% block sw_product_detail_prices_price_card_price_group_grid_currencies_list %}\r\n                    <template\r\n                        v-for="currency in currencies"\r\n                        :slot="`column-price-${currency.isoCode}`"\r\n                        slot-scope="{ item, column, compact }"\r\n                    >\r\n                        <template\r\n                            v-if="showListPrices[priceGroup.customerPriceId] === false"\r\n                        >\r\n                            <div\r\n                                :key="currency"\r\n                                class="product-detail-context-prices__price-field-wrapper"\r\n                            >\r\n                                {% block sw_product_detail_prices_price_card_price_group_grid_currencies_list_inherit_field %}\r\n                                <sw-inheritance-switch\r\n                                    v-if="!currency.isSystemDefault"\r\n                                    class="sw-product-detail-context-prices__inherited-icon"\r\n                                    :is-inherited="isPriceFieldInherited(item, currency)"\r\n                                    @inheritance-restore="onInheritanceRestore(item, currency)"\r\n                                    @inheritance-remove="onInheritanceRemove(item, currency)"\r\n                                />\r\n                                {% endblock %}\r\n\r\n                                {% block sw_product_detail_prices_price_card_price_group_grid_currencies_list_price_field %}\r\n                                <sw-price-field\r\n                                    :price="item.price"\r\n                                    :default-price="findDefaultPriceOfRule(item)"\r\n                                    :tax-rate="productTaxRate"\r\n                                    :label="false"\r\n                                    :compact="compact"\r\n                                    :name="`${item.customerPriceId}-${currency.isoCode}-${item.quantityStart}`"\r\n                                    :currency="currency"\r\n                                />\r\n                                {% endblock %}\r\n                            </div>\r\n                        </template>\r\n\r\n                        <template v-if="showListPrices[priceGroup.customerPriceId] !== false">\r\n                            <div\r\n                                :key="`else-${currency}`"\r\n                                class="product-detail-context-prices__price-field-wrapper"\r\n                            >\r\n                                <sw-inheritance-switch\r\n                                    v-if="!currency.isSystemDefault"\r\n                                    class="sw-product-detail-context-prices__inherited-icon"\r\n                                    :is-inherited="isPriceFieldInherited(item, currency)"\r\n                                    @inheritance-restore="onInheritanceRestore(item, currency)"\r\n                                    @inheritance-remove="onInheritanceRemove(item, currency)"\r\n                                />\r\n                                <sw-list-price-field\r\n                                    :price="item.price"\r\n                                    :default-price="findDefaultPriceOfRule(item)"\r\n                                    :vertical="true"\r\n                                    :tax-rate="productTaxRate"\r\n                                    :hidePurchasePrices="true"\r\n                                    :label="false"\r\n                                    :compact="compact"\r\n                                    :currency="currency"\r\n                                />\r\n                            </div>\r\n                        </template>\r\n                    </template>\r\n                    {% endblock %}\r\n\r\n                    {% block sw_product_detail_prices_price_card_price_group_grid_actions %}\r\n                    <template\r\n                        slot="actions"\r\n                        slot-scope="{ item }"\r\n                    >\r\n\r\n                        {% block sw_product_detail_prices_price_card_price_group_grid_actions_delete %}\r\n                        <sw-context-menu-item\r\n                            variant="danger"\r\n                            class="product-detail-context-prices__context-delete"\r\n                            @click="onPriceRuleDelete(item)"\r\n                        >\r\n                            {{ $tc(\'sw-product.prices.contextMenuDelete\') }}\r\n                        </sw-context-menu-item>\r\n                        {% endblock %}\r\n\r\n                    </template>\r\n                    {% endblock %}\r\n\r\n                </sw-data-grid>\r\n                {% endblock %}\r\n\r\n                {% block sw_product_detail_prices_price_card_price_group_empty_state %}\r\n                <div\r\n                    v-else\r\n                    class="sw-product-detail-context-prices__empty-state"\r\n                >\r\n\r\n                    {% block sw_product_detail_prices_price_card_price_group_empty_state_warning %}\r\n                    <p>{{ $tc(\'sw-product.advancedPrices.newRuleWarning\') }}</p>\r\n                    {% endblock %}\r\n\r\n                </div>\r\n                {% endblock %}\r\n\r\n            </sw-card>\r\n        </sw-container>\r\n        {% endblock %}\r\n\r\n    </sw-card-view>\r\n    {% endblock %}\r\n\r\n</sw-page>\r\n{% endblock %}\r\n',inject:["repositoryFactory","context"],mixins:[h.getByName("notification"),h.getByName("placeholder")],data:function(){return{item:null,isLoading:!1,processSuccess:!1,repository:null,isSaveSuccessful:!1,currencies:[],taxes:[],defaultCustomCurrency:null,defaultCustomPrice:null,rules:[],totalRules:0,isInherited:!1,showListPrices:{},customerPriceExist:!1}},metaInfo:function(){return{title:this.$createTitle()}},created:function(){this.createdComponent()},computed:{customerAdvancedPriceRepository:function(){return this.item&&this.item.acrisPrices?this.repositoryFactory.create(this.item.acrisPrices.entity,this.item.acrisPrices.source):null},productRepository:function(){return this.repositoryFactory.create("product")},currencyRepository:function(){return this.repositoryFactory.create("currency")},taxRepository:function(){return this.repositoryFactory.create("tax")},taxCriteria:function(){var e=new b(1,500);return e.addSorting(b.sort("position")),e},ruleRepository:function(){return this.repositoryFactory.create("rule")},priceRuleGroupsExists:function(){return Object.values(this.priceGroups).length>0},canAddPriceRule:function(){return Object.keys(this.priceGroups).length!==this.rules.length},emptyPriceRuleExists:function(){return void 0!==this.priceGroups.null},currencyColumns:function(){return this.sortCurrencies(),this.currencies.map((function(e){return{property:"price-".concat(e.isoCode),label:e.translated.name||e.name,visible:!0,allowResize:!0,primary:!1,rawData:!1,width:"250px",multiLine:!0}}))},pricesColumns:function(){return[].concat([{property:"quantityStart",label:"sw-product.advancedPrices.columnFrom",visible:!0,allowResize:!0,primary:!0,rawData:!1,width:"95px"},{property:"quantityEnd",label:"sw-product.advancedPrices.columnTo",visible:!0,allowResize:!0,primary:!0,rawData:!1,width:"95px"},{property:"type",label:"sw-product.advancedPrices.columnType",visible:!0,allowResize:!0,width:"250px",multiLine:!0}],p(this.currencyColumns))},productTaxRate:function(){var e=this;return this.taxes?this.item&&this.item.product&&this.item.product.taxId?this.taxes.find((function(r){return r.id===e.item.product.taxId})):this.taxes[0]:{}},customerPriceCriteria:function(){var e=new b;return e.addAssociation("product"),e.addAssociation("customer"),e.addAssociation("rules"),e.addAssociation("acrisPrices"),e},productSelectContext:function(){return d(d({},Shopware.Context.api),{},{inheritance:!0})},productCriteria:function(){var e=new b;return e.addAssociation("options.group"),e},priceGroups:function(){var e=this,r={};return this.item.acrisPrices?(this.item.acrisPrices.forEach((function(t){r[t.customerPriceId]||(r[t.customerPriceId]={customerPriceId:t.customerPriceId,prices:e.findPricesByPriceId(t.customerPriceId)})})),Object.values(r).forEach((function(e){e.prices.sort((function(e,r){return e.quantityStart-r.quantityStart}))})),r):r},listPriceTypes:function(){return[{label:this.$tc("acris-customer-price.detail.replaceOption"),value:"replace"},{label:this.$tc("acris-customer-price.detail.ifEmptyUseOriginalOption"),value:"ifEmptyUseOriginal"},{label:this.$tc("acris-customer-price.detail.ifBothEmptyUseNormalPriceOption"),value:"ifBothEmptyUseNormalPrice"}]}},methods:{createdComponent:function(){this.repository=this.repositoryFactory.create("acris_customer_price"),this.loadAll()},getEntity:function(){var e=this;this.repository.get(this.$route.params.id,Shopware.Context.api,this.customerPriceCriteria).then((function(r){e.item=r,e.item.product&&(e.defaultCustomPrice=e.getDefaultCustomPrice(e.item.product),e.item.product.parentId&&e.productRepository.get(e.item.product.parentId,Shopware.Context.api).then((function(r){e.item.product.taxId=r.taxId})),e.item.acrisPrices.length<=0&&e.onAddNewPriceGroup())}))},loadAll:function(){return Promise.all([this.getEntity(),this.loadCurrencies(),this.loadTaxes()])},loadCurrencies:function(){var e=this;return this.currencyRepository.search(new b(1,500)).then((function(r){e.currencies=r,e.defaultCustomCurrency=e.defaultCurrency()}))},loadTaxes:function(){var e=this;return this.taxRepository.search(this.taxCriteria).then((function(r){e.taxes=r}))},defaultCurrency:function(){return this.currencies.find((function(e){return e.isSystemDefault}))},getDefaultCustomPrice:function(e){var r=this;return e&&e.price&&this.defaultCustomCurrency?e.price.find((function(e){return e.currencyId===r.defaultCustomCurrency.id})):null},onClickSave:function(){var e=this;this.isLoading=!0;var r=this.$tc("acris-customer-price.detail.titleSaveError"),t=this.$tc("acris-customer-price.detail.messageSaveError"),i=this.$tc("acris-customer-price.detail.titleSaveSuccess"),c=this.$tc("acris-customer-price.detail.messageSaveSuccess");this.isSaveSuccessful=!1,this.isLoading=!0,this.item.acrisPrices.forEach((function(e){e.price&&e.price.forEach((function(e){e.listPrice&&(e.listPrice.net<=0||e.listPrice.gross<=0)&&(e.listPrice=null)}))})),this.repository.save(this.item,Shopware.Context.api).then((function(){e.loadAll(),e.isLoading=!1,e.processSuccess=!0,e.createNotificationSuccess({title:i,message:c})})).catch((function(){e.isLoading=!1,e.createNotificationError({title:r,message:t})}))},mountedComponent:function(){var e=this,r=new b(1,500);r.addFilter(b.multi("OR",[b.contains("rule.moduleTypes.types","price"),b.equals("rule.moduleTypes",null)])),Shopware.State.commit("swProductDetail/setLoading",["rules",!0]),this.ruleRepository.search(r).then((function(r){e.rules=r,e.totalRules=r.total,Shopware.State.commit("swProductDetail/setLoading",["rules",!1])})),this.isInherited=this.isChild&&!this.item.acrisPrices.total},sortCurrencies:function(){this.currencies.sort((function(e,r){return e.isSystemDefault?-1:r.isSystemDefault?1:e.translated.name<r.translated.name?-1:e.translated.name>r.translated.name?1:0}))},onRuleChange:function(e,r){this.item.acrisPrices.forEach((function(t){t.ruleId===r&&(t.ruleId=e)}))},onAddNewPriceGroup:function(){var e=this;if(this.defaultCustomPrice){var r=this.customerAdvancedPriceRepository.create();r.customerPriceId=this.item.id,r.quantityStart=1,r.quantityEnd=null,r.currencyId=this.defaultCustomCurrency.id,r.price=[{currencyId:this.defaultCustomCurrency.id,gross:this.defaultCustomPrice.gross,linked:this.defaultCustomPrice.linked,net:this.defaultCustomPrice.net,listPrice:null}],this.defaultCustomPrice.listPrice&&(r.price[0].listPrice={currencyId:this.defaultCustomCurrency.id,gross:this.defaultCustomPrice.listPrice.gross,linked:this.defaultCustomPrice.listPrice.linked,net:this.defaultCustomPrice.listPrice.net}),this.item.acrisPrices.add(r),this.$nextTick((function(){var r=e.$parent.$el.children.item(0);r&&r.scrollTo({top:r.scrollHeight,behavior:"smooth"})}))}},onPriceGroupDelete:function(e){var r=this;this.item.acrisPrices.map((function(e){return{id:e.id,ruleId:e.ruleId}})).forEach((function(t){e===t.ruleId&&r.item.acrisPrices.remove(t.id)}))},onPriceGroupDuplicate:function(e){var r=this;void 0===this.priceGroups.null&&e.prices.forEach((function(e){r.duplicatePriceRule(e,null)}))},onPriceRuleDelete:function(e){var r=this.priceGroups[e.customerPriceId];if(r.prices.length<=1)this.createNotificationError({message:this.$tc("sw-product.advancedPrices.deletionNotPossibleMessage")});else{var t=r.prices.indexOf(e);if(void 0===e.quantityEnd||null===e.quantityEnd)r.prices[t-1].quantityEnd=null;else r.prices[t+1].quantityStart=e.quantityStart;this.item.acrisPrices.remove(e.id)}},onInheritanceRestore:function(e,r){var t=e.price.findIndex((function(e){return e.currencyId===r.id}));this.$delete(e.price,t)},onInheritanceRemove:function(e,r){var t=this.findDefaultCustomPriceOfRule(e),i={currencyId:r.id,gross:this.convertPrice(t.gross,r),linked:t.linked,net:this.convertPrice(t.net,r),listPrice:null};t.listPrice&&(i.listPrice={currencyId:r.id,gross:this.convertPrice(t.listPrice.gross,r),linked:t.listPrice.linked,net:this.convertPrice(t.listPrice.net,r)}),this.$set(e.price,e.price.length,i)},isPriceFieldInherited:function(e,r){return e.price.findIndex((function(e){return e.currencyId===r.id}))<0},convertPrice:function(e,r){var t=(e*r.factor).toFixed(r.decimalPrecision);return Number(t)},findRuleById:function(e){return this.rules.find((function(r){return r.id===e}))},findPricesByPriceId:function(e){return this.item.acrisPrices.filter((function(r){return r.customerPriceId===e}))},findDefaultCustomPriceOfRule:function(e){var r=this;return e.price.find((function(e){return e.currencyId===r.defaultCustomCurrency.id}))},onQuantityEndChange:function(e,r){r.prices.indexOf(e)+1===r.prices.length&&this.createPriceRule(r)},createPriceRule:function(e){var r=this.customerAdvancedPriceRepository.create();r.customerPriceId=this.item.id;var t=Math.max.apply(Math,p(e.prices.map((function(e){return e.quantityEnd}))));r.quantityStart=t+1,r.price=[{currencyId:this.defaultCustomCurrency.id,gross:this.defaultCustomPrice.gross,linked:this.defaultCustomPrice.linked,net:this.defaultCustomPrice.net,listPrice:null}],this.defaultCustomPrice.listPrice&&(r.price[0].listPrice={currencyId:this.defaultCustomCurrency.id,gross:this.defaultCustomPrice.listPrice?this.defaultCustomPrice.listPrice.gross:null,linked:!this.defaultCustomPrice.listPrice||this.defaultCustomPrice.listPrice.linked,net:this.defaultCustomPrice.listPrice?this.defaultCustomPrice.listPrice.net:null}),this.item.acrisPrices.add(r)},canCreatePriceRule:function(e){return!!e.prices.filter((function(e){return!e.quantityEnd})).length},onProductChange:function(e,r){this.item.customerId&&this.checkCustomerPriceExisting(e,this.item.customerId,this.item.id),this.item.product=r,this.defaultCustomPrice=this.getDefaultCustomPrice(this.item.product),this.item.acrisPrices.length<=0&&this.onAddNewPriceGroup()},onCustomerChange:function(e){this.item.productId&&this.checkCustomerPriceExisting(this.item.productId,e,this.item.id)},checkCustomerPriceExisting:function(e,r,t){var i=this,c=new b(1,1);c.addFilter(b.equals("productId",e)),c.addFilter(b.equals("customerId",r)),c.addFilter(b.not("and",[b.equals("id",t)])),this.repository.search(c,Shopware.Context.api).then((function(e){i.customerPriceExist=e.total>0}))},duplicatePriceRule:function(e){var r=this,t=this.customerAdvancedPriceRepository.create();t.customerPriceId=e.customerPriceId,t.quantityEnd=e.quantityEnd,t.quantityStart=e.quantityStart,t.price=[],e.price.forEach((function(e,i){r.$set(t.price,i,d({},e))})),this.item.acrisPrices.add(t)},getPriceRuleGroupClass:function(e){return["context-price-group-".concat(e)]},restoreInheritance:function(){this.isInherited=!0},removeInheritance:function(){this.isInherited=!1},onChangeShowListPrices:function(e,r){this.$set(this.showListPrices,r,e)},getStartQuantityTooltip:function(e,r){return{message:this.$tc("sw-product.advancedPrices.advancedPriceDisabledTooltip"),width:275,showDelay:200,disabled:0!==e||1!==r}},findDefaultPriceOfRule:function(e){var r=this;return e.price.find((function(e){return e.currencyId===r.defaultCustomCurrency.id}))},saveFinish:function(){this.processSuccess=!1}}});t("K3lb");var P=t("mRvz"),y=t("vRie");Shopware.Module.register("acris-customer-price",{type:"plugin",name:"AcrisPartner",title:"acris-customer-price.general.mainMenuItemGeneral",description:"acris-customer-price.general.descriptionTextModule",version:"1.0.0",targetVersion:"1.0.0",color:"#a6c836",icon:"regular-user",favicon:"icon-module-settings.png",snippets:{"de-DE":P,"en-GB":y},routes:{index:{component:"acris-customer-price-list",path:"index",meta:{parentPath:"sw.settings.index"}},detail:{component:"acris-customer-price-detail",path:"detail/:id",meta:{parentPath:"acris.customer.price.index"}},create:{component:"acris-customer-price-create",path:"create",meta:{parentPath:"acris.customer.price.index"}}},settingsItem:[{name:"acris-customer-price-index",to:"acris.customer.price.index",label:"acris-customer-price.general.mainMenuItemGeneral",group:"plugins",icon:"regular-user"}]});t("l1FU");Shopware.Component.extend("acris-card-filter","sw-card-filter",{template:"{% block sw_card_filter_bar_container %}{% endblock %}\n"});t("kxIJ");function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,i)}return t}function w(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?v(Object(t),!0).forEach((function(r){C(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):v(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function C(e,r,t){return(r=function(e){var r=function(e,r){if("object"!==g(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,r||"default");if("object"!==g(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"===g(r)?r:String(r)}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function k(e){return function(e){if(Array.isArray(e))return x(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,r){if(!e)return;if("string"==typeof e)return x(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return x(e,r)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,i=new Array(r);t<r;t++)i[t]=e[t];return i}var S=Shopware.Mixin,E=Shopware.Data.Criteria,I=Shopware.Utils.object;I.cloneDeep,I.merge;Shopware.Component.register("acris-customer-price-product-modal-form",{template:'{% block acris_customer_price_product_modal_form %}\r\n    <div class="acris-customer-price-product-modal-form">\r\n\r\n        {% block acris_customer_price_product_modal_form_content_card %}\r\n        <sw-card :isLoading="isLoading" v-if="customerPrice"\r\n                 :large="true"\r\n                 :title="$tc(\'acris-customer-price.detail.cardGeneral\')">\r\n\r\n            <sw-alert v-if="customerPriceExist" variant="error">\r\n                {{ $tc(\'acris-customer-price.detail.customerPriceExistError\') }}\r\n            </sw-alert>\r\n\r\n            {% block acris_customer_price_detail_product_select %}\r\n            <sw-entity-single-select\r\n                v-model="customerPrice.productId"\r\n                entity="product"\r\n                v-if="!isProductPage"\r\n                :label="$tc(\'acris-customer-price.detail.fieldTitleLabelProduct\')"\r\n                :helpText="$tc(\'acris-customer-price.detail.fieldTitleHelpTextProduct\')"\r\n                :placeholder="$tc(\'acris-customer-price.detail.fieldTitlePlaceholderProduct\')"\r\n                @change="onProductChange"\r\n                required\r\n                :criteria="productCriteria"\r\n                :context="productSelectContext">\r\n\r\n                {% block acris_customer_price_detail_product_variant_label %}\r\n                <template #selection-label-property="{ item }">\r\n                    <sw-product-variant-info :variations="item.variation">\r\n                        {{ item.productNumber }} - {{ item.translated.name || item.name }}\r\n                    </sw-product-variant-info>\r\n                </template>\r\n                {% endblock %}\r\n\r\n                {% block acris_customer_price_detail_product_select_result_item %}\r\n                    <template #result-item="{ item, index }">\r\n                        <li is="sw-select-result" v-bind="{ item, index }">\r\n                            {% block acris_customer_price_detail_single_select_base_results_list_result_label %}\r\n                                <span class="sw-select-result__result-item-text">\r\n                              <sw-product-variant-info :variations="item.variation">\r\n                                    {{ item.productNumber }} - {{ item.translated.name || item.name }}\r\n                              </sw-product-variant-info>\r\n                         </span>\r\n                            {% endblock %}\r\n\r\n                        </li>\r\n                    </template>\r\n                {% endblock %}\r\n            </sw-entity-single-select>\r\n            {% endblock %}\r\n\r\n            {% block acris_customer_price_detail_product_form_link %}\r\n                <sw-container\r\n                    columns="1fr"\r\n                    v-if="customerPrice.productId && !isProductPage"\r\n                    justify="end"\r\n                    class="sw-product-price-form__links acris-customer-price-detail-select-field-link"\r\n                >\r\n                {% block acris_customer_price_detail_product_form_product_link %}\r\n                    <router-link\r\n                        :to="{ name: \'sw.product.detail\', params: { id: customerPrice.productId } }"\r\n                        class="sw-card__quick-link"\r\n                    >\r\n                    {{ $tc(\'acris-customer-price.detail.linkProduct\') }} <sw-icon\r\n                        name="regular-long-arrow-right"\r\n                        small\r\n                    />\r\n                    </router-link>\r\n                    {% endblock %}\r\n\r\n                    </sw-container>\r\n                    {% endblock %}\r\n\r\n            {% block acris_customer_price_detail_customer_select %}\r\n                <sw-entity-single-select\r\n                    v-model="customerPrice.customerId"\r\n                    v-if="isProductPage"\r\n                    entity="customer"\r\n                    @change="onCustomerChange"\r\n                    required\r\n                    :label="$tc(\'acris-customer-price.detail.fieldTitleLabelCustomer\')"\r\n                    :helpText="$tc(\'acris-customer-price.detail.fieldTitleHelpTextCustomer\')"\r\n                    :placeholder="$tc(\'acris-customer-price.detail.fieldTitlePlaceholderCustomer\')">\r\n\r\n                    {% block acris_customer_price_detail_customer_variant_label %}\r\n                        <template #selection-label-property="{ item }">\r\n                            {{ item.customerNumber }} - {{ item.email }} - {{ item.firstName }} {{ item.lastName }}\r\n                        </template>\r\n                    {% endblock %}\r\n\r\n                    {% block acris_customer_price_detail_customer_select_result_item %}\r\n                        <template #result-item="{ item, index }">\r\n                            <li is="sw-select-result" v-bind="{ item, index }">\r\n                                {% block acris_customer_price_detail_single_select_customer_base_results_list_result_label %}\r\n                                    <span class="sw-select-result__result-item-text">\r\n                                        {{ item.customerNumber }} - {{ item.email }} - {{ item.firstName }} {{ item.lastName }}\r\n                                    </span>\r\n                                {% endblock %}\r\n                            </li>\r\n                        </template>\r\n                    {% endblock %}\r\n                </sw-entity-single-select>\r\n            {% endblock %}\r\n\r\n            {% block acris_customer_price_detail_customer_form_link %}\r\n            <sw-container\r\n                columns="1fr"\r\n                v-if="customerPrice.customerId && isProductPage"\r\n                justify="end"\r\n                class="sw-product-price-form__links acris-customer-price-detail-select-field-link"\r\n            >\r\n                {% block acris_customer_price_detail_customer_form_customer_link %}\r\n                <router-link\r\n                    :to="{ name: \'sw.customer.detail\', params: { id: customerPrice.customerId } }"\r\n                    class="sw-card__quick-link"\r\n                >\r\n                    {{ $tc(\'acris-customer-price.detail.linkCustomer\') }} <sw-icon\r\n                        name="regular-long-arrow-right"\r\n                        small\r\n                    />\r\n                </router-link>\r\n                {% endblock %}\r\n\r\n            </sw-container>\r\n            {% endblock %}\r\n\r\n            {% block acris_customer_price_detail_content_active_checkbox_select %}\r\n                <sw-field v-model="customerPrice.active"\r\n                          type="switch"\r\n                          class="acris-customer-price-detail__item_active"\r\n                          :label="$tc(\'acris-customer-price.detail.fieldTitleLabelActive\')"\r\n                          :helpText="$tc(\'acris-customer-price.detail.fieldTitleHelpTextActive\')">\r\n                </sw-field>\r\n            {% endblock %}\r\n\r\n            {% block acris_customer_price_detail_base_active_container %}\r\n                <sw-container\r\n                    columns="1fr 1fr"\r\n                    gap="0 32px"\r\n                >\r\n\r\n                    {% block acris_customer_price_detail_active_from %}\r\n                        <sw-datepicker\r\n                            v-model="customerPrice.activeFrom"\r\n                            class="acris-customer-price-detail-base__field-active-from"\r\n                            date-type="datetime-local"\r\n                            :label="$tc(\'acris-customer-price.detail.fieldTitleLabelActiveFrom\')"\r\n                            :placeholder-text="$tc(\'acris-customer-price.detail.fieldTitlePlaceholderActiveFrom\')"\r\n                        />\r\n                    {% endblock %}\r\n\r\n                    {% block acris_customer_price_detail_active_until %}\r\n                        <sw-datepicker\r\n                            v-model="customerPrice.activeUntil"\r\n                            class="acris-customer-price-detail-base__field-active-until"\r\n                            date-type="datetime-local"\r\n                            :label="$tc(\'acris-customer-price.detail.fieldTitleLabelActiveUntil\')"\r\n                            :placeholder-text="$tc(\'acris-customer-price.detail.fieldTitlePlaceholderActiveUntil\')"\r\n                        />\r\n                    {% endblock %}\r\n\r\n                </sw-container>\r\n            {% endblock %}\r\n\r\n            {% block acris_customer_price_detail_content_list_price_type %}\r\n                <sw-select-field\r\n                    :label="$tc(\'acris-customer-price.detail.inputListPriceTypeLabel\')"\r\n                    :placeholder="$tc(\'acris-customer-price.detail.inputListPriceTypePlaceholder\')"\r\n                    :helpText="$tc(\'acris-customer-price.detail.inputListPriceTypeHelpText\')"\r\n                    v-model="customerPrice.listPriceType">\r\n                    <option v-for="option in listPriceTypes"\r\n                            :key="option.value"\r\n                            :value="option.value">\r\n                        {{ option.label }}\r\n                    </option>\r\n                </sw-select-field>\r\n            {% endblock %}\r\n\r\n        </sw-card>\r\n        {% endblock %}\r\n\r\n        {% block acris_customer_price_detail_content_card_conditions %}\r\n            <sw-card :isLoading="isLoading" v-if="customerPrice"\r\n                     :large="true"\r\n                     :title="$tc(\'acris-customer-price.detail.cardDisplayConditions\')">\r\n\r\n                {% block acris_customer_price_detail_content_rules %}\r\n                    <sw-entity-many-to-many-select\r\n                        v-if="customerPrice && customerPrice.rules"\r\n                        :localMode="true"\r\n                        class="acris-customer-price-detail__rules"\r\n                        :label="$tc(\'acris-customer-price.detail.rulesSelectFieldLabel\')"\r\n                        :helpText="$tc(\'acris-customer-price.detail.rulesSelectFieldHelpText\')"\r\n                        :placeholder="$tc(\'acris-customer-price.detail.rulesSelectFieldPlaceholder\')"\r\n                        v-model="customerPrice.rules">\r\n                    </sw-entity-many-to-many-select>\r\n                {% endblock %}\r\n\r\n            </sw-card>\r\n        {% endblock %}\r\n\r\n        {% block sw_product_detail_prices_price_card %}\r\n        <sw-container\r\n            rows="auto"\r\n            columns="100%"\r\n            class="sw-product-detail-context-prices"\r\n        >\r\n            <sw-card\r\n                v-for="(priceGroup, key, index) in priceGroups"\r\n                class="context-price"\r\n                :class="getPriceRuleGroupClass(index)"\r\n                :title="$tc(\'acris-customer-price.detail.cardAdvancedPrice\')"\r\n                :is-loading="isLoading"\r\n                :large="true"\r\n            >\r\n\r\n                {% block sw_product_detail_prices_price_card_price_group_grid %}\r\n                <sw-data-grid\r\n                    v-if="priceGroup"\r\n                    :data-source="priceGroup.prices"\r\n                    :columns="pricesColumns"\r\n                    show-settings\r\n                    :show-selection="false"\r\n                    :compact-mode="true"\r\n                >\r\n                    {% block sw_product_detail_prices_price_card_price_group_grid_settings %}\r\n                        <template #additionalSettings>\r\n                            {% block sw_product_detail_prices_price_card_price_group_grid_settings_list_prices %}\r\n                                <sw-switch-field\r\n                                    size="medium"\r\n                                    :value="showListPrices[priceGroup.customerPriceId] !== false"\r\n                                    no-margin-top\r\n                                    :label="$tc(\'sw-product.prices.settingShowListPrices\')"\r\n                                    @change="onChangeShowListPrices($event, priceGroup.customerPriceId)"\r\n                                />\r\n                            {% endblock %}\r\n                        </template>\r\n                    {% endblock %}\r\n\r\n                    {% block sw_product_detail_prices_price_card_price_group_grid_type %}\r\n                    <template\r\n                        slot="column-type"\r\n                        slot-scope="{ item, itemIndex, compact }"\r\n                    >\r\n                        <div class="sw-product-detail-context-prices__type-label">\r\n                            \r\n                            <label>{{ $tc(\'sw-product.advancedPrices.advancedListPricePriceLabel\') }}</label>\r\n                            \r\n                            <label v-if="showListPrices[priceGroup.customerPriceId] !== false">\r\n                                {{ $tc(\'acris-customer-price.detail.advancedListPriceLabel\') }}\r\n                            </label>\r\n                            \r\n                            <label v-if="showListPrices[priceGroup.customerPriceId] !== false">\r\n                                {{ $tc(\'acris-customer-price.detail.labelRegulationPrice\') }}\r\n                            </label>\r\n                        </div>\r\n                    </template>\r\n                    {% endblock %}\r\n\r\n                    {% block sw_product_detail_prices_price_card_price_group_grid_quantity_start %}\r\n                    <template\r\n                        slot="column-quantityStart"\r\n                        slot-scope="{ item, itemIndex, compact }"\r\n                    >\r\n                        {% block sw_product_detail_prices_price_card_price_group_grid_quantity_start_field %}\r\n                        <sw-field\r\n                            v-model="item.quantityStart"\r\n                            v-tooltip="getStartQuantityTooltip(itemIndex, item.quantityStart)"\r\n                            type="number"\r\n                            :name="`${item.customerPriceId}-${item.quantityStart}-quantityStart`"\r\n                            validation="required"\r\n                            :min="priceGroup.prices[itemIndex - 1] ? priceGroup.prices[itemIndex - 1].quantityEnd + 1 : 1"\r\n                            :max="item.quantityEnd ? item.quantityEnd : null"\r\n                            :size="compact ? \'small\' : \'default\'"\r\n                            :disabled="(itemIndex === 0 && item.quantityStart === 1)"\r\n                        />\r\n                        {% endblock %}\r\n                    </template>\r\n                    {% endblock %}\r\n\r\n                    {% block sw_product_detail_prices_price_card_price_group_grid_quantity_end %}\r\n                    <template\r\n                        slot="column-quantityEnd"\r\n                        slot-scope="{ item, itemIndex, compact }"\r\n                    >\r\n                        {% block sw_product_detail_prices_price_card_price_group_grid_quantity_end_field %}\r\n                        <sw-field\r\n                            v-model="item.quantityEnd"\r\n                            type="number"\r\n                            :validation="item.quantityEnd === null || item.quantityEnd > item.quantityStart"\r\n                            placeholder="∞"\r\n                            :name="`${item.customerPriceId}-${item.quantityStart}-quantityEnd`"\r\n                            :min="item.quantityStart"\r\n                            :max="priceGroup.prices[itemIndex + 1] ? priceGroup.prices[itemIndex + 1].quantityStart - 1 : null"\r\n                            :size="compact ? \'small\' : \'default\'"\r\n                            @change="onQuantityEndChange(item, priceGroup)"\r\n                        />\r\n                        {% endblock %}\r\n                    </template>\r\n                    {% endblock %}\r\n\r\n                    {% block sw_product_detail_prices_price_card_price_group_grid_currencies_list %}\r\n                    <template\r\n                        v-for="currency in currencies"\r\n                        :slot="`column-price-${currency.isoCode}`"\r\n                        slot-scope="{ item, column, compact }"\r\n                    >\r\n                        <template\r\n                            v-if="showListPrices[priceGroup.customerPriceId] === false"\r\n                        >\r\n                            <div\r\n                                :key="currency"\r\n                                class="product-detail-context-prices__price-field-wrapper"\r\n                            >\r\n                                {% block sw_product_detail_prices_price_card_price_group_grid_currencies_list_inherit_field %}\r\n                                <sw-inheritance-switch\r\n                                    v-if="!currency.isSystemDefault"\r\n                                    class="sw-product-detail-context-prices__inherited-icon"\r\n                                    :is-inherited="isPriceFieldInherited(item, currency)"\r\n                                    @inheritance-restore="onInheritanceRestore(item, currency)"\r\n                                    @inheritance-remove="onInheritanceRemove(item, currency)"\r\n                                />\r\n                                {% endblock %}\r\n\r\n                                {% block sw_product_detail_prices_price_card_price_group_grid_currencies_list_price_field %}\r\n                                <sw-price-field\r\n                                    :price="item.price"\r\n                                    :default-price="findDefaultPriceOfRule(item)"\r\n                                    :tax-rate="productTaxRate"\r\n                                    :label="false"\r\n                                    :compact="compact"\r\n                                    :name="`${item.customerPriceId}-${currency.isoCode}-${item.quantityStart}`"\r\n                                    :currency="currency"\r\n                                />\r\n                                {% endblock %}\r\n                            </div>\r\n                        </template>\r\n\r\n                        <template v-if="showListPrices[priceGroup.customerPriceId] !== false">\r\n                            <div\r\n                                :key="`else-${currency}`"\r\n                                class="product-detail-context-prices__price-field-wrapper"\r\n                            >\r\n                                <sw-inheritance-switch\r\n                                    v-if="!currency.isSystemDefault"\r\n                                    class="sw-product-detail-context-prices__inherited-icon"\r\n                                    :is-inherited="isPriceFieldInherited(item, currency)"\r\n                                    @inheritance-restore="onInheritanceRestore(item, currency)"\r\n                                    @inheritance-remove="onInheritanceRemove(item, currency)"\r\n                                />\r\n                                <sw-list-price-field\r\n                                    :price="item.price"\r\n                                    :default-price="findDefaultPriceOfRule(item)"\r\n                                    :vertical="true"\r\n                                    :tax-rate="productTaxRate"\r\n                                    :hidePurchasePrices="true"\r\n                                    :label="false"\r\n                                    :compact="compact"\r\n                                    :currency="currency"\r\n                                />\r\n                            </div>\r\n                        </template>\r\n                    </template>\r\n                    {% endblock %}\r\n\r\n                    {% block sw_product_detail_prices_price_card_price_group_grid_actions %}\r\n                    <template\r\n                        slot="actions"\r\n                        slot-scope="{ item }"\r\n                    >\r\n\r\n                        {% block sw_product_detail_prices_price_card_price_group_grid_actions_delete %}\r\n                        <sw-context-menu-item\r\n                            variant="danger"\r\n                            class="product-detail-context-prices__context-delete"\r\n                            @click="onPriceRuleDelete(item)"\r\n                        >\r\n                            {{ $tc(\'sw-product.prices.contextMenuDelete\') }}\r\n                        </sw-context-menu-item>\r\n                        {% endblock %}\r\n\r\n                    </template>\r\n                    {% endblock %}\r\n\r\n                </sw-data-grid>\r\n                {% endblock %}\r\n\r\n                {% block sw_product_detail_prices_price_card_price_group_empty_state %}\r\n                <div\r\n                    v-else\r\n                    class="sw-product-detail-context-prices__empty-state"\r\n                >\r\n\r\n                    {% block sw_product_detail_prices_price_card_price_group_empty_state_warning %}\r\n                    <p>{{ $tc(\'sw-product.advancedPrices.newRuleWarning\') }}</p>\r\n                    {% endblock %}\r\n\r\n                </div>\r\n                {% endblock %}\r\n\r\n            </sw-card>\r\n        </sw-container>\r\n        {% endblock %}\r\n\r\n    </div>\r\n{% endblock %}\r\n',inject:["repositoryFactory","context"],mixins:[S.getByName("notification"),S.getByName("placeholder")],props:{customerPrice:{type:Object,required:!0},item:{type:Object,required:!0},helpText:{type:String,required:!1},isLoading:{type:Boolean,required:!1},isProductPage:{type:Boolean,required:!1}},data:function(){return{item:null,isLoading:!1,processSuccess:!1,repository:null,isSaveSuccessful:!1,currencies:[],taxes:[],defaultCustomCurrency:null,defaultCustomPrice:null,rules:[],totalRules:0,isInherited:!1,showListPrices:{},customerPriceExist:!1}},created:function(){this.createdComponent()},watch:{defaultCustomCurrency:function(){this.defaultCustomCurrency&&this.getEntity()}},computed:{customerAdvancedPriceRepository:function(){return this.customerPrice&&this.customerPrice.acrisPrices?this.repositoryFactory.create(this.customerPrice.acrisPrices.entity,this.customerPrice.acrisPrices.source):null},productRepository:function(){return this.repositoryFactory.create("product")},currencyRepository:function(){return this.repositoryFactory.create("currency")},taxRepository:function(){return this.repositoryFactory.create("tax")},taxCriteria:function(){var e=new E(1,500);return e.addSorting(E.sort("position")),e},ruleRepository:function(){return this.repositoryFactory.create("rule")},priceRuleGroupsExists:function(){return Object.values(this.priceGroups).length>0},canAddPriceRule:function(){return Object.keys(this.priceGroups).length!==this.rules.length},emptyPriceRuleExists:function(){return void 0!==this.priceGroups.null},currencyColumns:function(){return this.sortCurrencies(),this.currencies.map((function(e){return{property:"price-".concat(e.isoCode),label:e.translated.name||e.name,visible:!0,allowResize:!0,primary:!1,rawData:!1,width:"250px",multiLine:!0}}))},pricesColumns:function(){return[].concat([{property:"quantityStart",label:"sw-product.advancedPrices.columnFrom",visible:!0,allowResize:!0,primary:!0,rawData:!1,width:"95px"},{property:"quantityEnd",label:"sw-product.advancedPrices.columnTo",visible:!0,allowResize:!0,primary:!0,rawData:!1,width:"95px"},{property:"type",label:"sw-product.advancedPrices.columnType",visible:!0,allowResize:!0,width:"250px",multiLine:!0}],k(this.currencyColumns))},productTaxRate:function(){var e=this;return this.taxes?this.item&&this.item.taxId?this.taxes.find((function(r){return r.id===e.item.taxId})):!this.isProductPage&&this.customerPrice&&this.customerPrice.product&&this.customerPrice.product.taxId?this.taxes.find((function(r){return r.id===e.customerPrice.product.taxId})):this.taxes[0]:{}},customerPriceCriteria:function(){var e=new E;return e.addAssociation("product"),e.addAssociation("customer"),e.addAssociation("rules"),e.addAssociation("acrisPrices"),e},productSelectContext:function(){return w(w({},Shopware.Context.api),{},{inheritance:!0})},productCriteria:function(){var e=new E;return e.addAssociation("options.group"),e},priceGroups:function(){var e=this,r={};return this.customerPrice.acrisPrices?(this.customerPrice.acrisPrices.forEach((function(t){r[t.customerPriceId]||(r[t.customerPriceId]={customerPriceId:t.customerPriceId,prices:e.findPricesByPriceId(t.customerPriceId)})})),Object.values(r).forEach((function(e){e.prices.sort((function(e,r){return e.quantityStart-r.quantityStart}))})),r):r},listPriceTypes:function(){return[{label:this.$tc("acris-customer-price.detail.replaceOption"),value:"replace"},{label:this.$tc("acris-customer-price.detail.ifEmptyUseOriginalOption"),value:"ifEmptyUseOriginal"},{label:this.$tc("acris-customer-price.detail.ifBothEmptyUseNormalPriceOption"),value:"ifBothEmptyUseNormalPrice"}]}},methods:{createdComponent:function(){this.repository=this.repositoryFactory.create("acris_customer_price"),this.loadAll()},getEntity:function(){var e=this;this.item&&(this.defaultCustomPrice=this.getDefaultCustomPrice(this.item),this.item.parentId&&this.productRepository.get(this.item.parentId,Shopware.Context.api).then((function(r){e.item.taxId=r.taxId,e.defaultCustomPrice||(e.defaultCustomPrice=e.getDefaultCustomPrice(r),e.customerPrice.acrisPrices.length<=0&&e.defaultCustomCurrency&&e.onAddNewPriceGroup())})),this.customerPrice.acrisPrices.length<=0&&this.defaultCustomCurrency&&this.onAddNewPriceGroup())},loadAll:function(){return Promise.all([this.loadCurrencies(),this.loadTaxes(),this.getEntity()])},loadCurrencies:function(){var e=this;return this.currencyRepository.search(new E(1,500)).then((function(r){e.currencies=r,e.defaultCustomCurrency=e.defaultCurrency()}))},loadTaxes:function(){var e=this;return this.taxRepository.search(this.taxCriteria).then((function(r){e.taxes=r}))},defaultCurrency:function(){return this.currencies.find((function(e){return e.isSystemDefault}))},getDefaultCustomPrice:function(e){var r=this;return e&&e.price&&this.defaultCustomCurrency?e.price.find((function(e){return e.currencyId===r.defaultCustomCurrency.id})):null},sortCurrencies:function(){this.currencies.sort((function(e,r){return e.isSystemDefault?-1:r.isSystemDefault?1:e.translated.name<r.translated.name?-1:e.translated.name>r.translated.name?1:0}))},onRuleChange:function(e,r){this.customerPrice.acrisPrices.forEach((function(t){t.ruleId===r&&(t.ruleId=e)}))},onAddNewPriceGroup:function(){var e=this;if(this.defaultCustomPrice){var r=this.customerAdvancedPriceRepository.create();r.customerPriceId=this.customerPrice.id,r.quantityStart=1,r.quantityEnd=null,r.currencyId=this.defaultCustomCurrency.id,r.price=[{currencyId:this.defaultCustomCurrency.id,gross:this.defaultCustomPrice.gross,linked:this.defaultCustomPrice.linked,net:this.defaultCustomPrice.net,listPrice:null}],this.defaultCustomPrice.listPrice&&(r.price[0].listPrice={currencyId:this.defaultCustomCurrency.id,gross:this.defaultCustomPrice.listPrice.gross,linked:this.defaultCustomPrice.listPrice.linked,net:this.defaultCustomPrice.listPrice.net}),this.customerPrice.acrisPrices.add(r),this.$nextTick((function(){var r=e.$parent.$el.children.item(0);r&&r.scrollTo({top:r.scrollHeight,behavior:"smooth"})}))}},onPriceGroupDelete:function(e){var r=this;this.customerPrice.acrisPrices.map((function(e){return{id:e.id,ruleId:e.ruleId}})).forEach((function(t){e===t.ruleId&&r.customerPrice.acrisPrices.remove(t.id)}))},onPriceGroupDuplicate:function(e){var r=this;void 0===this.priceGroups.null&&e.prices.forEach((function(e){r.duplicatePriceRule(e,null)}))},onPriceRuleDelete:function(e){var r=this.priceGroups[e.customerPriceId];if(r.prices.length<=1)this.createNotificationError({message:this.$tc("sw-product.advancedPrices.deletionNotPossibleMessage")});else{var t=r.prices.indexOf(e);if(void 0===e.quantityEnd||null===e.quantityEnd)r.prices[t-1].quantityEnd=null;else r.prices[t+1].quantityStart=e.quantityStart;this.customerPrice.acrisPrices.remove(e.id)}},onInheritanceRestore:function(e,r){var t=e.price.findIndex((function(e){return e.currencyId===r.id}));this.$delete(e.price,t)},onInheritanceRemove:function(e,r){var t=this.findDefaultCustomPriceOfRule(e),i={currencyId:r.id,gross:this.convertPrice(t.gross,r),linked:t.linked,net:this.convertPrice(t.net,r),listPrice:null};t.listPrice&&(i.listPrice={currencyId:r.id,gross:this.convertPrice(t.listPrice.gross,r),linked:t.listPrice.linked,net:this.convertPrice(t.listPrice.net,r)}),this.$set(e.price,e.price.length,i)},isPriceFieldInherited:function(e,r){return e.price.findIndex((function(e){return e.currencyId===r.id}))<0},convertPrice:function(e,r){var t=(e*r.factor).toFixed(r.decimalPrecision);return Number(t)},findRuleById:function(e){return this.rules.find((function(r){return r.id===e}))},findPricesByPriceId:function(e){return this.customerPrice.acrisPrices.filter((function(r){return r.customerPriceId===e}))},findDefaultCustomPriceOfRule:function(e){var r=this;return e.price.find((function(e){return e.currencyId===r.defaultCustomCurrency.id}))},onQuantityEndChange:function(e,r){r.prices.indexOf(e)+1===r.prices.length&&this.createPriceRule(r)},createPriceRule:function(e){var r=this.customerAdvancedPriceRepository.create();r.customerPriceId=this.customerPrice.id;var t=Math.max.apply(Math,k(e.prices.map((function(e){return e.quantityEnd}))));r.quantityStart=t+1,r.price=[{currencyId:this.defaultCustomCurrency.id,gross:this.defaultCustomPrice.gross,linked:this.defaultCustomPrice.linked,net:this.defaultCustomPrice.net,listPrice:null}],this.defaultCustomPrice.listPrice&&(r.price[0].listPrice={currencyId:this.defaultCustomCurrency.id,gross:this.defaultCustomPrice.listPrice?this.defaultCustomPrice.listPrice.gross:null,linked:!this.defaultCustomPrice.listPrice||this.defaultCustomPrice.listPrice.linked,net:this.defaultCustomPrice.listPrice?this.defaultCustomPrice.listPrice.net:null}),this.customerPrice.acrisPrices.add(r)},canCreatePriceRule:function(e){return!!e.prices.filter((function(e){return!e.quantityEnd})).length},onCustomerChange:function(e,r){this.customerPrice.customer=r,this.customerPrice.productId&&this.checkCustomerPriceExisting(this.customerPrice.productId,e,this.customerPrice.id)},onProductChange:function(e,r){this.customerPrice.customerId&&this.checkCustomerPriceExisting(e,this.customerPrice.customerId,this.customerPrice.id),this.customerPrice.product=r,this.defaultCustomPrice=this.getDefaultCustomPrice(this.customerPrice.product),this.customerPrice.acrisPrices.length<=0&&this.onAddNewPriceGroup()},checkCustomerPriceExisting:function(e,r,t){var i=this;if(this.customerPriceExist=!1,this.item.extensions.acrisCustomerPrice.forEach((function(t){t.productId===e&&t.customerId===r&&(i.customerPriceExist=!0)})),!0!==this.customerPriceExist){var c=new E(1,1);c.addFilter(E.equals("productId",e)),c.addFilter(E.equals("customerId",r)),c.addFilter(E.not("and",[E.equals("id",t)])),this.repository.search(c,Shopware.Context.api).then((function(e){i.customerPriceExist=e.total>0,Shopware.State.commit("customerPriceState/setCustomerPriceExist",i.customerPriceExist),Shopware.State.commit("customerPriceStateCustomer/setCustomerPriceExist",i.customerPriceExist)}))}else Shopware.State.commit("customerPriceState/setCustomerPriceExist",this.customerPriceExist),Shopware.State.commit("customerPriceStateCustomer/setCustomerPriceExist",this.customerPriceExist)},duplicatePriceRule:function(e){var r=this,t=this.customerAdvancedPriceRepository.create();t.customerPriceId=e.customerPriceId,t.quantityEnd=e.quantityEnd,t.quantityStart=e.quantityStart,t.price=[],e.price.forEach((function(e,i){r.$set(t.price,i,w({},e))})),this.customerPrice.acrisPrices.add(t)},getPriceRuleGroupClass:function(e){return["context-price-group-".concat(e)]},restoreInheritance:function(){this.isInherited=!0},removeInheritance:function(){this.isInherited=!1},onChangeShowListPrices:function(e,r){this.$set(this.showListPrices,r,e)},getStartQuantityTooltip:function(e,r){return{message:this.$tc("sw-product.advancedPrices.advancedPriceDisabledTooltip"),width:275,showDelay:200,disabled:0!==e||1!==r}},findDefaultPriceOfRule:function(e){var r=this;return e.price.find((function(e){return e.currencyId===r.defaultCustomCurrency.id}))},saveFinish:function(){this.processSuccess=!1}}});Shopware.Component.override("sw-product-detail",{template:'{% block sw_product_detail_content_tabs_cross_selling %}\n    {% parent() %}\n\n    {% block acris_customer_price_product_tab %}\n    <sw-tabs-item class="acris-customer-prices-product-tab"\n                  :route="{ name: \'acris.customer.prices.product.tab\', params: { id: $route.params.id } }"\n                  :product="product"\n                  :title="$tc(\'acris-customer-prices-product-tab.tabTitle\')">\n        {{ $tc(\'acris-customer-prices-product-tab.tabTitle\') }}\n    </sw-tabs-item>\n    {% endblock %}\n{% endblock %}\n'});var T={namespaced:!0,state:function(){return{customerPriceExist:!1}},mutations:{setCustomerPriceExist:function(e,r){e.customerPriceExist=r}}};function D(e){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,i)}return t}function L(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?$(Object(t),!0).forEach((function(r){R(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):$(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function R(e,r,t){return(r=function(e){var r=function(e,r){if("object"!==D(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,r||"default");if("object"!==D(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"===D(r)?r:String(r)}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var A=Shopware.Component,O=Shopware.Component.getComponentHelper(),q=O.mapGetters,M=O.mapState,j=Shopware.Data.Criteria;A.register("acris-customer-prices-product-tab",{template:'{% block acris_customer_prices_product_tab_tab_tabs %}\r\n<div class="acris-product-tab-detail-tabs">\r\n    {% block acris_customer_prices_product_tab_tab_add_modal %}\r\n    <sw-modal v-if="currentCustomerPrice"\r\n              variant="full"\r\n              @modal-close="onCloseCustomerPriceModal"\r\n              :title="$tc(\'acris-customer-prices-product-tab.titleModalProducts\')">\r\n        {% block acris_customer_prices_product_tab_tab_add_modal_field_form %}\r\n            <acris-customer-price-product-modal-form :customerPrice="currentCustomerPrice"\r\n                                       :item="product"\r\n                                       :helpText="helpTextCustomerPrice"\r\n                                       :isLoading="isLoading"\r\n                                       :isProductPage="isProductPage"\r\n                                     v-if="product">\r\n            </acris-customer-price-product-modal-form>\r\n        {% endblock %}\r\n\r\n        {% block acris_customer_prices_product_tab_tab_add_modal_footer %}\r\n        <template #modal-footer>\r\n            {% block acris_customer_prices_product_tab_tab_add_modal_cancel %}\r\n            <sw-button size="small" @click="onCloseCustomerPriceModal">\r\n                {{ $tc(\'acris-customer-prices-product-tab.modalProductCancelButton\') }}\r\n            </sw-button>\r\n            {% endblock %}\r\n\r\n            {% block acris_customer_prices_product_tab_tab_add_modal_apply %}\r\n            <sw-button variant="primary" size="small" @click="onSaveCustomerPrice"\r\n                       :disabled="!currentCustomerPrice.customerId || customerPriceExist">\r\n                {{ $tc(\'acris-customer-prices-product-tab.modalProductApplyButton\') }}\r\n            </sw-button>\r\n            {% endblock %}\r\n        </template>\r\n        {% endblock %}\r\n    </sw-modal>\r\n    {% endblock %}\r\n\r\n    {% block acris_customer_prices_product_tab_content_fields_card_customer_prices %}\r\n    <sw-card :isLoading="isLoading"\r\n             :large="true"\r\n             :title="$tc(\'acris-customer-prices-product-tab.cardCustomerPrice\')">\r\n\r\n        {% block acris_customer_prices_product_tab_toolbar_customer_prices %}\r\n        <template #toolbar>\r\n            <sw-card-filter placeholder=""\r\n                               @sw-card-filter-term-change="onChange">\r\n            <template #filter>\r\n                    {% block acris_customer_prices_product_tab_add_button_customer_prices %}\r\n                    <sw-button class="acris-customer-prices-product-tab-field__add-field-action"\r\n                               size="small"\r\n                               @click="onCreateNewCustomerPrice">\r\n                        <sw-icon name="regular-plus-circle-s" small></sw-icon>\r\n                        {{ $tc(\'acris-customer-prices-product-tab.buttonAddCustomerPrice\') }}\r\n                    </sw-button>\r\n                    {% endblock %}\r\n                </template>\r\n            </sw-card-filter>\r\n        </template>\r\n        {% endblock %}\r\n\r\n        {% block acris_customer_prices_product_tab_grid_customer_prices %}\r\n        <template #grid>\r\n            <acris-one-to-many-grid v-if="product && customerPrices && customerPrices.total > 0"\r\n                                 :collection="customerPrices"\r\n                                 ref="customerPriceGrid"\r\n                                 :localMode="true"\r\n                                 :columns="customerPriceColumns"\r\n                                 :showSelection="false"\r\n                                 @column-sort="setCustomerPriceSorting"\r\n                                 :sortDirection="customerPriceSortDirection"\r\n                                 :sortBy="customerPriceSortProperty"\r\n                                 :isLoading="isLoading">\r\n\r\n                {% block acris_customer_prices_product_tab_grid_columns_product_customer_price_customer_number %}\r\n                <template #column-customer.customerNumber="{ item }">\r\n                    <a @click="onEditCustomerPrice(item)" v-if="item.customer">\r\n                        {{ item.customer.customerNumber }}\r\n                    </a>\r\n                </template>\r\n                {% endblock %}\r\n\r\n                {% block acris_customer_prices_product_tab_grid_columns_product_customer_price_customer_email %}\r\n                    <template #column-customer.email="{ item }">\r\n                        <a @click="onEditCustomerPrice(item)" v-if="item.customer">\r\n                            {{ item.customer.email }}\r\n                        </a>\r\n                    </template>\r\n                {% endblock %}\r\n\r\n                {% block acris_customer_prices_product_tab_grid_columns_product_customer_price_customer %}\r\n                <template #column-customer="{ item }">\r\n                    <a @click="onEditCustomerPrice(item)" v-if="item.customer">\r\n                        {{ item.customer.firstName }} {{ item.customer.lastName }}\r\n                    </a>\r\n                </template>\r\n                {% endblock %}\r\n\r\n                {% block acris_customer_prices_product_tab_grid_columns_product_customer_price_active %}\r\n                    <template #column-active="{ item }">\r\n                        <template>\r\n                            <sw-icon v-if="item.active" name="regular-checkmark-xs" small\r\n                                     class="is--active"></sw-icon>\r\n                            <sw-icon v-else name="small-default-x-line-medium" small class="is--inactive"></sw-icon>\r\n                        </template>\r\n                    </template>\r\n                {% endblock %}\r\n\r\n                {% block acris_customer_prices_product_tab_grid_columns_product_customer_price_rules %}\r\n                    <template #column-rules="{ item }">\r\n                        <div v-bind:class="{ \'acris-no-rule\' : item.rules.length == 0}">\r\n                            <sw-label\r\n                                    v-for="rule in item.rules"\r\n                                    appearance="default"\r\n                                    size="default">\r\n                                {{ rule.name }}\r\n                            </sw-label>\r\n                        </div>\r\n                    </template>\r\n                {% endblock %}\r\n\r\n                {% block acris_customer_prices_product_tab_grid_columns_product_customer_price_acris_prices %}\r\n                <template #column-acrisPrices="{ item, isInlineEdit }">\r\n                    {% block acris_customer_prices_product_tab_grid_columns_acris_prices %}\r\n                    <template v-if="item.acrisPrices && item.acrisPrices.length > 0 && item.acrisPrices[0] && item.acrisPrices[0].price[0]">\r\n                        <a @click="onEditCustomerPrice(item)">{{ $tc(\'acris-customer-price.list.acrisPricesLabel\', 0, { netPrice: item.acrisPrices[0].price[0].net, grossPrice: item.acrisPrices[0].price[0].gross }) }}</a>\r\n                    </template>\r\n                    <template v-else>\r\n                        {{ $tc(\'acris-customer-price.list.emptyAcrisPrices\') }}\r\n                    </template>\r\n                    {% endblock %}\r\n                </template>\r\n                {% endblock %}\r\n\r\n                {% block acris_customer_prices_product_tab_grid_columns_actions_customer_prices %}\r\n                <template #actions="{ item }">\r\n\r\n                    {% block acris_customer_prices_product_tab_grid_columns_actions_edit_customer_prices %}\r\n                    <sw-context-menu-item @click="onEditCustomerPrice(item)">\r\n                        {{ $tc(\'acris-customer-prices-product-tab.contextMenuEdit\') }}\r\n                    </sw-context-menu-item>\r\n                    {% endblock %}\r\n\r\n                    {% block acris_customer_prices_product_tab_grid_columns_actions_delete_customer_prices %}\r\n                    <sw-context-menu-item @click="onDeleteCustomerPrice(item.id)"\r\n                                          variant="danger">\r\n                        {{ $tc(\'acris-customer-prices-product-tab.contextMenuDelete\') }}\r\n                    </sw-context-menu-item>\r\n                    {% endblock %}\r\n                </template>\r\n                {% endblock %}\r\n\r\n                {% block acris_customer_prices_product_tab_grid_columns_action_modals_customer_prices %}\r\n                <template #action-modals="{ item }">\r\n                    {% block acris_customer_prices_product_tab_delete_modal_customer_prices %}\r\n                    <sw-modal v-if="showDeleteCustomerPriceModal === item.id"\r\n                              @modal-close="onCloseDeleteCustomerPriceModal"\r\n                              :title="$tc(\'acris-customer-prices-product-tab.modalTitleDeleteProduct\')"\r\n                              variant="small">\r\n                        {% block acris_customer_prices_product_tab_delete_modal_confirm_delete_text_customer_prices %}\r\n                        <p class="sw-product-detail-field__confirm-delete-text">\r\n                            {{ $tc(\'acris-customer-prices-product-tab.textDeleteProductConfirm\') }}\r\n                        </p>\r\n                        {% endblock %}\r\n\r\n                        {% block acris_customer_prices_product_tab_delete_modal_footer_customer_prices %}\r\n                        <template #modal-footer>\r\n                            {% block acris_customer_prices_product_tab_delete_modal_cancel_customer_prices %}\r\n                            <sw-button @click="onCloseDeleteCustomerPriceModal"\r\n                                       size="small">\r\n                                {{ $tc(\'acris-customer-prices-product-tab.buttonCancel\') }}\r\n                            </sw-button>\r\n                            {% endblock %}\r\n\r\n                            {% block acris_customer_prices_product_tab_delete_modal_confirm_customer_prices %}\r\n                            <sw-button @click="onConfirmDeleteCustomerPrice(item.id)"\r\n                                       variant="danger"\r\n                                       size="small">\r\n                                {{ $tc(\'acris-customer-prices-product-tab.buttonDelete\') }}\r\n                            </sw-button>\r\n                            {% endblock %}\r\n                        </template>\r\n                        {% endblock %}\r\n                    </sw-modal>\r\n                    {% endblock %}\r\n                </template>\r\n                {% endblock %}\r\n            </acris-one-to-many-grid>\r\n        </template>\r\n        {% endblock %}\r\n    </sw-card>\r\n    {% endblock %}\r\n\r\n</div>\r\n{% endblock %}\r\n',inject:["repositoryFactory","acl"],props:{allowEdit:{type:Boolean,required:!1,default:!0}},data:function(){return{isLoading:!1,customerPrices:null,showAddCustomerPriceModal:!1,showEditCustomerPriceModal:!1,showDeleteCustomerPriceModal:!1,customerPriceSortProperty:null,customerPriceSortDirection:"",currentCustomerPrice:null,helpTextCustomerPrice:this.$tc("acris-customer-prices-product-tab.fieldTitleHelpTextCustomerPrice"),isProductPage:!0}},beforeCreate:function(){Shopware.State.registerModule("customerPriceState",T)},created:function(){this.createdComponent()},computed:L(L(L({customerPriceRepository:function(){return this.repositoryFactory.create("acris_customer_price")},customerPriceColumns:function(){return this.getCustomerPriceColumns()}},M("swProductDetail",["product"])),q("swProductDetail",["isLoading"])),{},{customerPriceExist:function(){return Shopware.State.get("customerPriceState").customerPriceExist}}),methods:{getCustomerPriceColumns:function(){return[{property:"customer.customerNumber",label:"acris-customer-price.list.columnCustomerNumber"},{property:"customer.email",label:"acris-customer-price.list.columnCustomerEmail"},{property:"customer",label:"acris-customer-price.list.columnCustomer"},{property:"acrisPrices",label:"acris-customer-price.list.columnListPrice"},{property:"rules",label:"acris-customer-price.list.columnRules"},{property:"active",label:"acris-customer-price.list.columnActive",width:"80px",align:"center"}]},createdComponent:function(){this.isLoading=!0,this.refreshList()},setCustomerPriceSorting:function(e){this.customerPriceSortProperty=e.property;var r="ASC";this.customerPriceSortProperty===e.dataIndex&&this.customerPriceSortDirection===r&&(r="DESC"),this.customerPriceSortProperty=e.dataIndex,this.customerPriceSortDirection=r},onChange:function(e){this.customerPrices.criteria.setPage(1),this.customerPrices.criteria.setTerm(e),this.refreshList()},refreshList:function(){var e=this,r=new j(1,25);this.customerPrices&&this.customerPrices.criteria?r=this.customerPrices.criteria:r.addFilter(j.equals("productId",this.product.id)),r.addAssociation("customer").addAssociation("acrisPrices").addAssociation("rules"),this.customerPriceRepository.search(r).then((function(r){e.customerPrices=r,e.product.extensions.acrisCustomerPrice=r,e.isLoading=!1}))},onCreateNewCustomerPrice:function(){this.showAddCustomerPriceModal=!0,this.createNewCustomerPrice()},createNewCustomerPrice:function(){var e=this.customerPriceRepository.create(Shopware.Context.api);e.productId=this.product.id,e.listPriceType="replace",e.active=!0,this.currentCustomerPrice=e},onSaveCustomerPrice:function(){if(null!==this.currentCustomerPrice){this.currentCustomerPrice.acrisPrices.forEach((function(e){e.price&&e.price.forEach((function(e){e.listPrice&&(e.listPrice.net<=0||e.listPrice.gross<=0)&&(e.listPrice=null)}))}));var e=this.customerPrices.get(this.currentCustomerPrice.id);null==e&&(e=this.customerPriceRepository.create(Shopware.Context.api,this.currentCustomerPrice.id)),Object.assign(e,this.currentCustomerPrice),this.customerPrices.has(e.id)||this.customerPrices.push(e),this.product.extensions.acrisCustomerPrice=this.customerPrices,this.currentCustomerPrice=null,this.$refs.customerPriceGrid.applyResult(this.product.extensions.acrisCustomerPrice)}},onCloseCustomerPriceModal:function(){this.$route.query.hasOwnProperty("detailId")&&(this.$route.query.detailId=null),this.currentCustomerPrice=null},onEditCustomerPrice:function(e){this.currentCustomerPrice=e,this.showEditCustomerPriceModal=e.id},onDeleteCustomerPrice:function(e){this.showDeleteCustomerPriceModal=e},onConfirmDeleteCustomerPrice:function(e){var r=this;this.onCloseDeleteCustomerPriceModal(),this.product.extensions.acrisCustomerPrice=this.customerPrices,this.$nextTick((function(){r.product.extensions.acrisCustomerPrice.remove(e)})),this.$refs.customerPriceGrid.applyResult(this.product.extensions.acrisCustomerPrice),this.customerPriceRepository.delete(e,Shopware.Context.api)},onCloseDeleteCustomerPriceModal:function(){this.showDeleteCustomerPriceModal=!1}}});t("HXgV"),t("BsCe");Shopware.Component.override("sw-customer-detail",{template:"{% block sw_customer_detail_content_tab_order %}\n    {% parent %}\n\n    {% block acris_customer_price_customer_tab %}\n    <sw-tabs-item class=\"acris-customer-price-customer-tab\"\n                  :route=\"{ name: 'acris.customer.prices.customer.tab', params: { id: $route.params.id } }\"\n                  :title=\"$tc('acris-customer-prices-customer-tab.tabTitle')\">\n        {{ $tc('acris-customer-prices-customer-tab.tabTitle') }}\n    </sw-tabs-item>\n    {% endblock %}\n{% endblock %}\n\n"});var N={namespaced:!0,state:function(){return{customerPriceExist:!1}},mutations:{setCustomerPriceExist:function(e,r){e.customerPriceExist=r}}};function G(e){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function z(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,i)}return t}function F(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?z(Object(t),!0).forEach((function(r){B(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):z(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function B(e,r,t){return(r=function(e){var r=function(e,r){if("object"!==G(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,r||"default");if("object"!==G(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"===G(r)?r:String(r)}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var U=Shopware.Component,H=Shopware.Data.Criteria;U.register("acris-customer-prices-customer-tab",{template:'{% block acris_customer_prices_customer_tab_tab_tabs %}\r\n<div class="acris-customer-tab-detail-tabs">\r\n    {% block acris_customer_prices_customer_tab_tab_add_modal %}\r\n    <sw-modal v-if="currentCustomerPrice"\r\n              variant="full"\r\n              @modal-close="onCloseCustomerPriceModal"\r\n              :title="$tc(\'acris-customer-prices-customer-tab.titleModalCustomers\')">\r\n        {% block acris_customer_prices_customer_tab_tab_add_modal_field_form %}\r\n            <acris-customer-price-product-modal-form :customerPrice="currentCustomerPrice"\r\n                                                     :item="customer"\r\n                                                     :helpText="helpTextCustomerPrice"\r\n                                                     :isLoading="isLoading"\r\n                                                     :isProductPage="isProductPage"\r\n                                                     v-if="customer">\r\n            </acris-customer-price-product-modal-form>\r\n        {% endblock %}\r\n\r\n        {% block acris_customer_prices_customer_tab_tab_add_modal_footer %}\r\n        <template #modal-footer>\r\n            {% block acris_customer_prices_customer_tab_tab_add_modal_cancel %}\r\n            <sw-button size="small" @click="onCloseCustomerPriceModal">\r\n                {{ $tc(\'acris-customer-prices-customer-tab.modalCustomerCancelButton\') }}\r\n            </sw-button>\r\n            {% endblock %}\r\n\r\n            {% block acris_customer_prices_customer_tab_tab_add_modal_apply %}\r\n            <sw-button variant="primary" size="small" @click="onSaveCustomerPrice"\r\n                       :disabled="!currentCustomerPrice.productId || customerPriceExist">\r\n                {{ $tc(\'acris-customer-prices-customer-tab.modalCustomerApplyButton\') }}\r\n            </sw-button>\r\n            {% endblock %}\r\n        </template>\r\n        {% endblock %}\r\n    </sw-modal>\r\n    {% endblock %}\r\n\r\n    {% block acris_customer_prices_customer_tab_content_fields_card_customer_prices %}\r\n    <sw-card :isLoading="isLoading"\r\n             :large="true"\r\n             :title="$tc(\'acris-customer-prices-customer-tab.cardCustomerPrice\')">\r\n\r\n        {% block acris_customer_prices_customer_tab_toolbar_customer_prices %}\r\n        <template #toolbar>\r\n            <sw-card-filter placeholder=""\r\n                            @sw-card-filter-term-change="onChange">\r\n            <template #filter>\r\n                    {% block acris_customer_prices_customer_tab_add_button_customer_prices %}\r\n                    <sw-button class="acris-customer-prices-customer-tab-field__add-field-action"\r\n                               size="small"\r\n                               @click="onCreateNewCustomerPrice">\r\n                        <sw-icon name="regular-plus-circle-s" small></sw-icon>\r\n                        {{ $tc(\'acris-customer-prices-customer-tab.buttonAddCustomerPrice\') }}\r\n                    </sw-button>\r\n                    {% endblock %}\r\n                </template>\r\n            </sw-card-filter>\r\n        </template>\r\n        {% endblock %}\r\n\r\n        {% block acris_customer_prices_customer_tab_grid_customer_prices %}\r\n        <template #grid>\r\n            <acris-one-to-many-grid v-if="customer && customerPrices && customerPrices.total > 0"\r\n                                    :collection="customerPrices"\r\n                                    ref="customerPriceGrid"\r\n                                    :localMode="true"\r\n                                    :columns="customerPriceColumns"\r\n                                    :showSelection="false"\r\n                                    @column-sort="setCustomerPriceSorting"\r\n                                    :sortDirection="customerPriceSortDirection"\r\n                                    :sortBy="customerPriceSortProperty"\r\n                                    :isLoading="isLoading">\r\n\r\n                {% block acris_customer_prices_customer_tab_grid_columns_customer_customer_price_product_number %}\r\n                <template #column-product.productNumber="{ item }">\r\n                    <a @click="onEditCustomerPrice(item)" v-if="item.product && item.product.productNumber">\r\n                        {{ item.product.productNumber }}\r\n                    </a>\r\n                </template>\r\n                {% endblock %}\r\n\r\n                {% block acris_customer_prices_customer_tab_grid_columns_customer_customer_price_product %}\r\n                <template #column-product="{ item }">\r\n                    <a @click="onEditCustomerPrice(item)" v-if="item.product">\r\n                        {{ getProductInfo(item) }}\r\n\r\n                        <sw-product-variant-info :variations="item.product.variation" :show-tooltip="false">\r\n                            {{ item.product.translated.name || item.product.name }}\r\n                        </sw-product-variant-info>\r\n                    </a>\r\n                </template>\r\n                {% endblock %}\r\n\r\n                {% block acris_customer_prices_customer_tab_grid_columns_customer_customer_price_active %}\r\n                    <template #column-active="{ item }">\r\n                        <template>\r\n                            <sw-icon v-if="item.active" name="regular-checkmark-xs" small\r\n                                     class="is--active"></sw-icon>\r\n                            <sw-icon v-else name="small-default-x-line-medium" small class="is--inactive"></sw-icon>\r\n                        </template>\r\n                    </template>\r\n                {% endblock %}\r\n\r\n                {% block acris_customer_prices_customer_tab_grid_columns_customer_customer_price_rules %}\r\n                    <template #column-rules="{ item }">\r\n                        <div v-bind:class="{ \'acris-no-rule\' : item.rules.length == 0}">\r\n                            <sw-label\r\n                                    v-for="rule in item.rules"\r\n                                    appearance="default"\r\n                                    size="default">\r\n                                {{ rule.name }}\r\n                            </sw-label>\r\n                        </div>\r\n                    </template>\r\n                {% endblock %}\r\n\r\n                {% block acris_customer_prices_customer_tab_grid_columns_product_customer_price_acris_prices %}\r\n                <template #column-acrisPrices="{ item, isInlineEdit }">\r\n                    {% block acris_customer_prices_customer_tab_grid_columns_acris_prices %}\r\n                    <template v-if="item.acrisPrices && item.acrisPrices.length > 0 && item.acrisPrices[0] && item.acrisPrices[0].price[0]">\r\n                        <a @click="onEditCustomerPrice(item)">{{ $tc(\'acris-customer-price.list.acrisPricesLabel\', 0, { netPrice: item.acrisPrices[0].price[0].net, grossPrice: item.acrisPrices[0].price[0].gross }) }}</a>\r\n                    </template>\r\n                    <template v-else>\r\n                        {{ $tc(\'acris-customer-price.list.emptyAcrisPrices\') }}\r\n                    </template>\r\n                    {% endblock %}\r\n                </template>\r\n                {% endblock %}\r\n\r\n                {% block acris_customer_prices_customer_tab_grid_columns_actions_customer_prices %}\r\n                <template #actions="{ item }">\r\n\r\n                    {% block acris_customer_prices_customer_tab_grid_columns_actions_edit_customer_prices %}\r\n                    <sw-context-menu-item @click="onEditCustomerPrice(item)">\r\n                        {{ $tc(\'acris-customer-prices-customer-tab.contextMenuEdit\') }}\r\n                    </sw-context-menu-item>\r\n                    {% endblock %}\r\n\r\n                    {% block acris_customer_prices_customer_tab_grid_columns_actions_delete_customer_prices %}\r\n                    <sw-context-menu-item @click="onDeleteCustomerPrice(item.id)"\r\n                                          variant="danger">\r\n                        {{ $tc(\'acris-customer-prices-customer-tab.contextMenuDelete\') }}\r\n                    </sw-context-menu-item>\r\n                    {% endblock %}\r\n                </template>\r\n                {% endblock %}\r\n\r\n                {% block acris_customer_prices_customer_tab_grid_columns_action_modals_customer_prices %}\r\n                <template #action-modals="{ item }">\r\n                    {% block acris_customer_prices_customer_tab_delete_modal_customer_prices %}\r\n                    <sw-modal v-if="showDeleteCustomerPriceModal === item.id"\r\n                              @modal-close="onCloseDeleteCustomerPriceModal"\r\n                              :title="$tc(\'acris-customer-prices-customer-tab.modalTitleDeleteCustomer\')"\r\n                              variant="small">\r\n                        {% block acris_customer_prices_customer_tab_delete_modal_confirm_delete_text_customer_prices %}\r\n                        <p class="sw-customer-detail-field__confirm-delete-text">\r\n                            {{ $tc(\'acris-customer-prices-customer-tab.textDeleteCustomerConfirm\') }}\r\n                        </p>\r\n                        {% endblock %}\r\n\r\n                        {% block acris_customer_prices_customer_tab_delete_modal_footer_customer_prices %}\r\n                        <template #modal-footer>\r\n                            {% block acris_customer_prices_customer_tab_delete_modal_cancel_customer_prices %}\r\n                            <sw-button @click="onCloseDeleteCustomerPriceModal"\r\n                                       size="small">\r\n                                {{ $tc(\'acris-customer-prices-customer-tab.buttonCancel\') }}\r\n                            </sw-button>\r\n                            {% endblock %}\r\n\r\n                            {% block acris_customer_prices_customer_tab_delete_modal_confirm_customer_prices %}\r\n                            <sw-button @click="onConfirmDeleteCustomerPrice(item.id)"\r\n                                       variant="danger"\r\n                                       size="small">\r\n                                {{ $tc(\'acris-customer-prices-customer-tab.buttonDelete\') }}\r\n                            </sw-button>\r\n                            {% endblock %}\r\n                        </template>\r\n                        {% endblock %}\r\n                    </sw-modal>\r\n                    {% endblock %}\r\n                </template>\r\n                {% endblock %}\r\n            </acris-one-to-many-grid>\r\n        </template>\r\n        {% endblock %}\r\n    </sw-card>\r\n    {% endblock %}\r\n\r\n</div>\r\n{% endblock %}\r\n',inject:["repositoryFactory","acl"],props:{customer:{type:Object,required:!0},customerEditMode:{type:Boolean,required:!0,default:!1},isLoading:{type:Boolean,required:!1,default:!1}},data:function(){return{customerPrices:null,showAddCustomerPriceModal:!1,showEditCustomerPriceModal:!1,showDeleteCustomerPriceModal:!1,customerPriceSortProperty:null,customerPriceSortDirection:"",currentCustomerPrice:null,helpTextCustomerPrice:this.$tc("acris-customer-prices-customer-tab.fieldTitleHelpTextCustomerPrice"),isProductPage:!1}},beforeCreate:function(){Shopware.State.registerModule("customerPriceStateCustomer",N)},created:function(){this.createdComponent()},computed:{customerPriceRepository:function(){return this.repositoryFactory.create("acris_customer_price")},productVariantContext:function(){return F(F({},Shopware.Context.api),{},{inheritance:!0})},customerPriceColumns:function(){return this.getCustomerPriceColumns()},customerPriceExist:function(){return Shopware.State.get("customerPriceStateCustomer").customerPriceExist},productRepository:function(){return this.repositoryFactory.create("product")}},methods:{getProductInfo:function(e){var r=e;r&&r.product&&r.product.parentId&&this.productRepository.get(r.product.parentId,Shopware.Context.api).then((function(e){r.product.name=e.name,r.product.translated.name=e.translated.name}))},createdComponent:function(){this.isLoading=!0,this.refreshList()},getCustomerPriceColumns:function(){return[{property:"product.productNumber",label:"acris-customer-price.list.columnProductNumber"},{property:"product",label:"acris-customer-price.list.columnProduct"},{property:"acrisPrices",label:"acris-customer-price.list.columnListPrice"},{property:"rules",label:"acris-customer-price.list.columnRules"},{property:"active",label:"acris-customer-price.list.columnActive",width:"80px",align:"center"}]},onChange:function(e){this.customerPrices.criteria.setPage(1),this.customerPrices.criteria.setTerm(e),this.refreshList()},refreshList:function(){var e=this,r=new H(1,25);this.customerPrices&&this.customerPrices.criteria?r=this.customerPrices.criteria:r.addFilter(H.equals("customerId",this.customer.id)),r.addAssociation("product").addAssociation("product.options.group").addAssociation("acrisPrices").addAssociation("rules"),this.customerPriceRepository.search(r).then((function(r){e.customerPrices=r,e.customer.extensions.acrisCustomerPrice=r,e.customer&&e.customerPrices&&e.customerPrices.total>0&&e.setVariantProductNames(),e.isLoading=!1}))},setVariantProductNames:function(){var e=this;this.customerPrices.forEach((function(r){r.product&&r.product.parentId&&e.productRepository.get(r.product.parentId,Shopware.Context.api).then((function(e){r.product.name=e.name,r.product.translated.name=e.translated.name}))}))},setCustomerPriceSorting:function(e){this.customerPriceSortProperty=e.property;var r="ASC";this.customerPriceSortProperty===e.dataIndex&&this.customerPriceSortDirection===r&&(r="DESC"),this.customerPriceSortProperty=e.dataIndex,this.customerPriceSortDirection=r},onCreateNewCustomerPrice:function(){this.showAddCustomerPriceModal=!0,this.createNewCustomerPrice()},createNewCustomerPrice:function(){var e=this.customerPriceRepository.create(Shopware.Context.api);e.customerId=this.customer.id,e.listPriceType="replace",e.active=!0,this.currentCustomerPrice=e},onSaveCustomerPrice:function(){if(null!==this.currentCustomerPrice){this.currentCustomerPrice.acrisPrices.forEach((function(e){e.price&&e.price.forEach((function(e){e.listPrice&&(e.listPrice.net<=0||e.listPrice.gross<=0)&&(e.listPrice=null)}))}));var e=this.customerPrices.get(this.currentCustomerPrice.id);null==e&&(e=this.customerPriceRepository.create(Shopware.Context.api,this.currentCustomerPrice.id)),Object.assign(e,this.currentCustomerPrice),this.customerPrices.has(e.id)||this.customerPrices.push(e),this.customer.extensions.acrisCustomerPrice=this.customerPrices,this.currentCustomerPrice=null,this.$refs.customerPriceGrid.applyResult(this.customer.extensions.acrisCustomerPrice)}},onCloseCustomerPriceModal:function(){this.$route.query.hasOwnProperty("detailId")&&(this.$route.query.detailId=null),this.currentCustomerPrice=null},onEditCustomerPrice:function(e){this.currentCustomerPrice=e,this.showEditCustomerPriceModal=e.id},onDeleteCustomerPrice:function(e){this.showDeleteCustomerPriceModal=e},onConfirmDeleteCustomerPrice:function(e){var r=this;this.onCloseDeleteCustomerPriceModal(),this.customer.extensions.acrisCustomerPrice=this.customerPrices,this.$nextTick((function(){r.customer.extensions.acrisCustomerPrice.remove(e)})),this.$refs.customerPriceGrid.applyResult(this.customer.extensions.acrisCustomerPrice),this.customerPriceRepository.delete(e,Shopware.Context.api)},onCloseDeleteCustomerPriceModal:function(){this.showDeleteCustomerPriceModal=!1}}})},"th+M":function(e,r,t){},vRie:function(e){e.exports=JSON.parse('{"acris-customer-price":{"general":{"mainMenuItemGeneral":"Customer Price","descriptionTextModule":"Configure customer prices.","placeholderSearchBar":"Search customer prices"},"list":{"textHeadline":"Customer price","buttonAdd":"Add customer price","emptyAcrisPrices":"There are no assigned customer specific prices","acrisPricesLabel":"Net price: {netPrice}, gross price: {grossPrice}","columnProductNumber":"Product number","columnCustomerNumber":"Customer number","columnCustomerEmail":"Customer E-mail","columnProduct":"Product name","columnCustomer":"Customer name","columnListPrice":"Price","columnRules":"Rules","columnActive":"Active","contextMenuView":"View","contextMenuDelete":"Delete","contentEmpty":"There are no customer prices.","contextMenuDuplicate":"Duplicate","contextMenuEdit":"Edit","messageEmpty":"No customer prices yet.","messageSaveError":"Customer price could not be saved.","messageSaveSuccess":"Customer price has been saved.","modalTitleDelete":"Delete customer price","textDeleteConfirm":"Are you sure you want to delete this customer price?","buttonCancel":"Cancel","buttonDelete":"Delete","titleSidebarItemRefresh":"Refresh","titleSidebarItemFilter":"Filter"},"detail":{"textHeadline":"Customer price configuration","buttonSave":"Save","buttonCancel":"Cancel","cardGeneral":"General","cardDisplayConditions":"Display conditions","cardAdvancedPrice":"Prices","fieldTitleLabelProduct":"Product","fieldTitlePlaceholderProduct":"Enter product...","fieldTitleHelpTextProduct":"The customer price will be displayed for the assigned product at Storefront.","fieldTitleLabelCustomer":"Customer","fieldTitlePlaceholderCustomer":"Enter customer...","fieldTitleHelpTextCustomer":"The customer price will be displayed for the assigned product if the assigned customer is logged in at Storefront.","fieldTitleLabelActive":"Active","fieldTitleHelpTextActive":"If active, then the customer price will be displayed for assigned product and customer at Storefront.","fieldTitleLabelActiveFrom":"Active from","fieldTitlePlaceholderActiveFrom":"Enter active from date...","fieldTitleLabelActiveUntil":"Active until","fieldTitlePlaceholderActiveUntil":"Enter active until date...","advancedListPriceLabel":"List price","labelRegulationPrice":"Cheapest price (last 30 days)","linkProduct":"Open selected product","linkCustomer":"Open selected customer","inputListPriceTypeLabel":"List price type","inputListPriceTypePlaceholder":"Select list price...","inputListPriceTypeHelpText":"The list price will be displayed for the assigned product at Storefront based on selected option.","rulesSelectFieldLabel":"Additional rules","rulesSelectFieldPlaceholder":"Select rules...","rulesSelectFieldHelpText":"The price becomes active if one of the specified rules matches (OR link). If no rule is selected, the price is always active for the product and the customer.","replaceOption":"Always replace product list price, even if none was specified here","ifEmptyUseOriginalOption":"If no list price was specified here, use the original list price","ifBothEmptyUseNormalPriceOption":"If no list price has been specified here and the product does not have a list price, use the original product price as the list price","customerPriceExistError":"The customer price with assigned product and customer already exists.\\nPlease assign different product or customer.","titleSaveError":"Error","titleSaveSuccess":"Success","messageSaveError":"Customer price could not be saved.","messageSaveSuccess":"Customer price has been saved."}},"acris-customer-prices-product-tab":{"tabTitle":"Customer prices","cardCustomerPrice":"Prices configuration","contextMenuEdit":"Edit","contextMenuDelete":"Delete","modalTitleDeleteProduct":"Delete customer price","textDeleteProductConfirm":"Do you want to delete customer price?","buttonAddCustomerPrice":"Add customer price","buttonCancel":"Cancel","buttonDelete":"Delete","titleModalProducts":"Customer price","modalProductCancelButton":"Cancel","modalProductApplyButton":"Apply"},"acris-customer-prices-customer-tab":{"tabTitle":"Customer prices","cardCustomerPrice":"Prices configuration","contextMenuEdit":"Edit","contextMenuDelete":"Delete","modalTitleDeleteCustomer":"Delete customer price","textDeleteCustomerConfirm":"Do you want to delete customer price?","buttonAddCustomerPrice":"Add customer price","buttonCancel":"Cancel","buttonDelete":"Delete","titleModalCustomers":"Customer price","modalCustomerCancelButton":"Cancel","modalCustomerApplyButton":"Apply"}}')}});