<?xml version="1.0" ?>

<container xmlns="http://symfony.com/schema/dic/services"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">

    <services>
        <!-- Definitions -->
        <service id="Swag\DynamicAccess\DataAbstractionLayer\CategoryRule\CategoryRuleDefinition">
            <tag name="shopware.entity.definition" entity="swag_dynamic_access_category_rule" />
        </service>
        <service id="Swag\DynamicAccess\DataAbstractionLayer\LandingPageRule\LandingPageRuleDefinition">
            <tag name="shopware.entity.definition" entity="swag_dynamic_access_category_rule" />
        </service>
        <service id="Swag\DynamicAccess\DataAbstractionLayer\ProductRule\ProductRuleDefinition">
            <tag name="shopware.entity.definition" entity="swag_dynamic_access_product_rule" />
        </service>

        <!-- Extensions -->
        <service id="Swag\DynamicAccess\DataAbstractionLayer\Extension\CategoryExtension">
            <tag name="shopware.entity.extension" />
        </service>
        <service id="Swag\DynamicAccess\DataAbstractionLayer\Extension\LandingPageExtension">
            <tag name="shopware.entity.extension" />
        </service>
        <service id="Swag\DynamicAccess\DataAbstractionLayer\Extension\ProductExtension">
            <tag name="shopware.entity.extension" />
        </service>
        <service id="Swag\DynamicAccess\DataAbstractionLayer\Extension\RuleExtension">
            <tag name="shopware.entity.extension" />
        </service>

        <!-- Decorations -->
        <service id="Swag\DynamicAccess\Core\Content\Product\SalesChannel\SalesChannelCriteriaSubscriber">
            <tag name="kernel.event_subscriber"/>
        </service>

        <service id="Swag\DynamicAccess\Core\Content\Category\SalesChannel\DecoratedCategoryRoute"
                 decorates="Shopware\Core\Content\Category\SalesChannel\CategoryRoute">
            <argument type="service" id=".inner"/>
            <argument type="service" id="sales_channel.category.repository"/>
            <argument type="service" id="Shopware\Core\Content\Category\Service\CategoryBreadcrumbBuilder"/>
        </service>

        <service id="Swag\DynamicAccess\Core\Content\Category\SalesChannel\DecoratedNavigationRoute"
                 decorates="Shopware\Core\Content\Category\SalesChannel\NavigationRoute">
            <argument type="service" id=".inner"/>
            <argument type="service" id="sales_channel.category.repository"/>
        </service>

        <service id="Swag\DynamicAccess\ElasticSearch\ProductEsDefinitionDecorator"
                 decorates="Shopware\Elasticsearch\Product\ElasticsearchProductDefinition"
                 decoration-on-invalid="ignore">
            <argument type="service" id=".inner"/>
            <argument type="service" id="Doctrine\DBAL\Connection"/>
        </service>

        <service id="Swag\DynamicAccess\ElasticSearch\CategoryEsDefinitionDecorator"
                 decorates="Swag\EnterpriseSearch\Category\CategoryEsDefinition"
                 decoration-on-invalid="ignore">
            <argument type="service" id=".inner"/>
            <argument type="service" id="Doctrine\DBAL\Connection"/>
        </service>

        <!-- Validator -->
        <service id="Swag\DynamicAccess\Core\Checkout\Cart\LineItem\LineItemValidator">
            <argument type="service" id="product.repository"/>
            <tag name="shopware.cart.validator"/>
        </service>

        <!-- Subscriber -->
        <service id="Swag\DynamicAccess\Core\Content\Category\CategoryRule\CategoryRuleSubscriber">
            <argument type="service" id="Shopware\Core\Framework\Adapter\Cache\CacheInvalidator"/>
            <tag name="kernel.event_subscriber"/>
        </service>
    </services>
</container>
