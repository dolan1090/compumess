{% block sw_cms_list_delete_modal %}
{% parent %}

<publisher-draft-modal
    v-if="showDraftsModal && draftsModalPage"
    :page="draftsModalPage"
    @close-modal="closeDraftModal"
    @refresh-list="getList"
></publisher-draft-modal>
{% endblock %}

{% block sw_cms_list_listing_list_item %}
<sw-cms-list-item
    v-for="(cmsPage, index) in pages"
    :key="cmsPage.id"
    :class="'sw-cms-list-item--' + index"
    :page="cmsPage"
    :active="layoutIsLinked(cmsPage.id)"
    :is-default="[defaultProductId, defaultCategoryId].includes(cmsPage.id)"
    @item-click="onListItemClick"
    @preview-image-change="onPreviewChange"
    @cms-page-delete="onDeleteCmsPage"
    @showDraftsModal="openDraftModal"
>
    <template #contextMenu>
        <sw-context-button class="sw-cms-list-item__options">

            {% block sw_cms_list_listing_list_item_option_add_preview %}
            <sw-context-menu-item
                class="sw-cms-list-item__option-preview"
                :disabled="!acl.can('cms.editor') || (currentPageType === 'draft' && !acl.can('cms_page_draft:update'))"
                @click="onPreviewChange(cmsPage)"
            >
                {{ $tc('sw-cms.components.cmsListItem.addPreviewImage') }}
            </sw-context-menu-item>
            {% endblock %}

            <sw-context-menu-item
                v-if="cmsPage.type === 'product_list' && !(defaultCategoryId === cmsPage.id)"
                class="sw-cms-list-item__option-set-as-default"
                :disabled="!acl.can('system_config.editor')"
                @click="onOpenLayoutSetAsDefault(cmsPage)"
            >
                {{ $tc('sw-cms.components.cmsListItem.setAsDefaultProductList') }}
            </sw-context-menu-item>

            <!-- @deprecated tag:v6.5.0 default layouts for products will be enabled -->
            <sw-context-menu-item
                v-else-if="feature.isActive('v6.6.0.0') && cmsPage.type === 'product_detail' && !(defaultProductId === cmsPage.id)"
                class="sw-cms-list-item__option-set-as-default"
                :disabled="!acl.can('cms.editor')"
                @click="onOpenLayoutSetAsDefault(cmsPage)"
            >
                {{ $tc('sw-cms.components.cmsListItem.setAsDefaultProductDetail') }}
            </sw-context-menu-item>

            <sw-context-menu-item
                :disabled="!acl.can('cms.creator')"
                class="sw-cms-list-item__option-duplicate"
                @click="onDuplicateCmsPage(cmsPage)"
            >
                {{ $tc('sw-cms.components.cmsListItem.duplicate') }}
            </sw-context-menu-item>

            {% block sw_cms_list_listing_list_item_option_remove_preview %}
            <sw-context-menu-item
                v-if="cmsPage.previewMediaId"
                class="sw-cms-list-item__option-preview"
                variant="danger"
                :disabled="!acl.can('cms.editor') || (currentPageType === 'draft' && !acl.can('cms_page_draft:update'))"
                @click="onPreviewImageRemove(cmsPage)"
            >
                {{ $tc('sw-cms.components.cmsListItem.removePreviewImage') }}
            </sw-context-menu-item>
            {% endblock %}

            {% block sw_cms_list_listing_list_item_option_delete %}
            <sw-context-menu-item
                v-if="!cmsPage.locked && !(defaultProductId === cmsPage.id || defaultCategoryId === cmsPage.id)"
                v-tooltip="deleteDisabledToolTip(cmsPage)"
                class="sw-cms-list-item__option-delete"
                variant="danger"
                :disabled="optionContextDeleteDisabled(cmsPage)"
                @click="onDeleteCmsPage(cmsPage)"
            >
                {{ $tc('global.default.delete') }}
            </sw-context-menu-item>
            {% endblock %}

        </sw-context-button>
    </template>
</sw-cms-list-item>
{% endblock %}
