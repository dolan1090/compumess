<sw-modal
    class="sw-settings-subscription-plan-products-modal"
    :title="$tc('commercial.subscriptions.settings.plan.addProducts')"
    size="900px"
    @modal-close="onCancel"
>
    <template #default>
        <sw-card position-identifier="sw-settings-subscription-plan-products-modal">
            <template #toolbar>
                <sw-card-filter
                    v-if="(products && products.length > 0) || term"
                    @sw-card-filter-term-change="onChangeTerm"
                />
            </template>

            <template
                v-if="(products && products.length) || term"
                #grid
            >
                <sw-entity-listing
                    class="sw-settings-subscription-plan-products-modal__products"
                    :repository="productRepository"
                    :is-loading="isLoading"
                    :columns="productColumns"
                    :items="products"
                    :show-selection="acl.can('plans_and_intervals.editor')"
                    :allow-delete="false"
                    :allow-view="false"
                    :allow-edit="false"
                    :full-page="false"
                    :show-settings="false"
                    :allow-column-edit="false"
                    :plain-appearance="true"
                    :allow-inline-edit="false"
                    detail-route="sw.product.detail"
                    @selection-change="onSelectionChange"
                >
                    <template #column-name="{ item }">
                        <router-link
                            :to="{ name: 'sw.product.detail', params: { id: item.id } }"
                        >
                            <sw-product-variant-info :variations="item.variation">
                                {{ item.name || item.translated.name }}
                            </sw-product-variant-info>
                        </router-link>
                    </template>
                </sw-entity-listing>
            </template>
        </sw-card>
    </template>

    <template #modal-footer>
        <sw-button
            class="sw-settings-subscription-plan-products-modal__cancel-btn"
            size="small"
            @click="onCancel"
        >
            {{ $tc('global.default.cancel') }}
        </sw-button>

        <sw-button
            class="sw-settings-subscription-plan-products-modal__save-btn"
            size="small"
            variant="primary"
            @click="onSave"
            :disabled="!acl.can('plans_and_intervals.editor')"
        >
            {{ $tc('commercial.subscriptions.settings.plan.addProductsButton', productsCount, { selectedProductsLength: productsCount }) }}
        </sw-button>
    </template>
</sw-modal>
