<sw-card
    position-identifier="sw-subscription-detail-orders"
    class="sw-subscription-detail-orders"
    :title="$tc('commercial.subscriptions.subscriptions.detail.tabOrders')"
>

    <template
        v-if="(orders && orders.length > 0) || term"
        #toolbar
    >
        <sw-card-filter @sw-card-filter-term-change="onChangeTerm" />
    </template>

    <template
        v-if="(orders && orders.length > 0) || term"
        #grid
    >
        <sw-entity-listing
            ref="entityListing"
            :repository="orderRepository"
            :is-loading="isLoading"
            :columns="orderColumns"
            :items="orders"
            :allow-column-edit="false"
            :show-settings="false"
            :show-selection="false"
            :allow-delete="acl.can('subscription.editor')"
            :allow-view="acl.can('subscription.viewer')"
            :allow-edit="acl.can('subscription.editor')"
            :full-page="false"
            detail-route="sw.order.detail"
        >
            <template #column-orderNumber="{ item }">
                <router-link :to="{ name: 'sw.order.detail', params: { id: item.id } }">
                    {{ item.orderNumber }}
                </router-link>
            </template>

            <template #column-amountTotal="{ item }">
                {{ item.amountTotal | currency(item.currency.shortName) }}
            </template>

            <template #column-orderDateTime="{ item }">
                <sw-time-ago :date="item.orderDateTime" />
            </template>

            <template #pagination>
                <sw-pagination
                    :page="orderCriteria.page"
                    :limit="orderCriteria.limit"
                    :total="orders.total"
                    :total-visible="5"
                    :auto-hide="false"
                    @page-change="onChangePage"
                />
            </template>

            <template #actions="{ item }">
                <sw-context-menu-item
                    class="sw-subscription-detail-orders__view-action"
                    :router-link="{ name: 'sw.order.detail', params: { id: item.id } }"
                >
                    {{ $tc('commercial.subscriptions.subscriptions.detail.orders.contextOpenOrder') }}
                </sw-context-menu-item>
            </template>
        </sw-entity-listing>
    </template>

    <template v-if="(!orders || orders.length === 0) && !isLoading && !term">
        <sw-empty-state
            :title="$tc('commercial.subscriptions.subscriptions.detail.orders.emptyOrdersTitle')"
            :absolute="false"
            :subline="$tc('commercial.subscriptions.subscriptions.detail.orders.emptyOrdersSubline')"
        >
            <template #icon>
                <img
                    :src="'/administration/static/img/empty-states/order-empty-state.svg' | asset"
                    :alt="$tc('commercial.subscriptions.subscriptions.detail.orders.emptyProductsTitle')"
                >
            </template>
        </sw-empty-state>
    </template>
</sw-card>
