"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["text-translator"],{6056:(e,t,r)=>{var i=r(6285),n=r(8254),a=r(4690);function o(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class s extends i.Z{constructor(...e){super(...e),o(this,"reviews",[])}init(){this.reviewTranslateOptions=JSON.parse(this.el.dataset.reviewTranslator),this.alertWrapper=document.querySelector(s.options.alertWrapperSelector),document.body.addEventListener("click",this._onClickButton.bind(this))}_onClickButton(e){var t;const r=e.target;if("BUTTON"!==r.tagName||void 0===(null===(t=r.dataset)||void 0===t?void 0:t.reviewId))return;const i=r.closest(s.options.reviewItemSelector),n=r.dataset.reviewId;let a=this.reviews.find((e=>e.id===n));var o,l;void 0===a&&(this.reviews.push({id:n,originalTitle:i.querySelector(s.options.reviewTitleSelector).innerHTML,originalContent:i.querySelector(s.options.reviewContentSelector).innerHTML,originalComment:null!==(o=null===(l=i.querySelector(s.options.reviewCommentSelector))||void 0===l?void 0:l.innerHTML)&&void 0!==o?o:null,isTranslated:!1}),a=this.reviews.find((e=>e.id===n)));this._translate(a,i)}_translate(e,t){if(null!=e&&e.translatedTitle||null!=e&&e.translatedContent)return void this._updateText(e);a.Z.create(t);(new n.Z).post(s.options.reviewTranslateUrl,JSON.stringify({reviewId:e.id}),((e,r)=>{200==r.status?(this.alertWrapper.hidden=!0,this._processTranslation(e)):this.alertWrapper.hidden=!1,a.Z.remove(t)}))}_processTranslation(e){const t=JSON.parse(e),r=this.reviews.find((e=>e.id===t.id));r.translatedTitle=t.title,r.translatedContent=t.content,r.translatedComment=t.comment,r.translatedLanguageName=t.language_name,this._updateText(r)}_updateText(e){const t=document.querySelector(`[data-review-id="${e.id}"]`),r=t.closest(s.options.reviewItemSelector),i=e.isTranslated?e.originalTitle:e.translatedTitle,n=e.isTranslated?e.originalContent:e.translatedContent,a=e.isTranslated?e.originalComment:" "+this.reviewTranslateOptions.snippets.ourFeedback+e.translatedComment,o=e.isTranslated?this.reviewTranslateOptions.snippets.translateTo:this.reviewTranslateOptions.snippets.revertToOriginal,l=e.isTranslated?"":this.reviewTranslateOptions.snippets.translatedFrom.replace("%language%",e.translatedLanguageName);r.querySelector(s.options.reviewTitleSelector).innerHTML=i,r.querySelector(s.options.reviewContentSelector).innerHTML=n,r.querySelector(s.options.translatedFromSelector).innerHTML=l;const d=r.querySelector(s.options.reviewCommentSelector);null!==d&&(d.innerHTML=a),t.innerHTML=o,e.isTranslated=!e.isTranslated}}o(s,"options",{reviewItemSelector:".product-detail-review-item",buttonSelector:"[data-review-id]",reviewTranslateUrl:window.router["frontend.product.review.translate"],reviewTitleSelector:".product-detail-review-item-title > .h5",reviewContentSelector:".product-detail-review-item-content",reviewCommentSelector:".product-detail-review-item-comment .blockquote-footer",alertWrapperSelector:".review-tab-pane-alert-wrapper",translatedFromSelector:".swag-text-translator_translated-from"});window.PluginManager.register("ReviewTranslator",s,"[data-review-translator]")}},e=>{e.O(0,["vendor-node","vendor-shared"],(()=>{return t=6056,e(e.s=t);var t}));e.O()}]);